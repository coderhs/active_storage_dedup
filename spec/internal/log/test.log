  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:50:37.519159', '2025-11-23 03:50:37.519160') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:50:44.030537', '2025-11-23 03:50:44.030539') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:51:40.007714', '2025-11-23 03:51:40.007716') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:52:15.883002', '2025-11-23 03:52:15.883003') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:52:52.825287', '2025-11-23 03:52:52.825288') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:53:30.886592', '2025-11-23 03:53:30.886593') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 03:59:48.759207', '2025-11-23 03:59:48.759208') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:00:31.842551', '2025-11-23 04:00:31.842552') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:02.661482', '2025-11-23 04:01:02.661484') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:02.699215', '2025-11-23 04:01:02.699216') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:01:02.745244"], ["updated_at", "2025-11-23 04:01:02.745244"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:01:02.747265"], ["updated_at", "2025-11-23 04:01:02.747265"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:01:02.748997"], ["updated_at", "2025-11-23 04:01:02.748997"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:09.695150', '2025-11-23 04:01:09.695152') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:09.718335', '2025-11-23 04:01:09.718336') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:20.519663', '2025-11-23 04:01:20.519665') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:20.543229', '2025-11-23 04:01:20.543230') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:31.234213', '2025-11-23 04:01:31.234214') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:31.271772', '2025-11-23 04:01:31.271773') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:59.531016', '2025-11-23 04:01:59.531018') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:01:59.554977', '2025-11-23 04:01:59.554979') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "inj45lt22ztst6immf4e55qizt3s"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:01:59.588283"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:01:59.591614"], ["updated_at", "2025-11-23 04:01:59.591614"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:01:59.601175"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:06.415001', '2025-11-23 04:02:06.415002') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:06.438697', '2025-11-23 04:02:06.438698') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p61s79n5883outzsjp6194k9rcwt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.480681"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.483679"], ["updated_at", "2025-11-23 04:02:06.483679"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.491704"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.492938"], ["updated_at", "2025-11-23 04:02:06.492938"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jjgmpkhnaqjcgar0wcnr9ubjg4it"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.494328"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.494563"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:06.495617"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: jjgmpkhnaqjcgar0wcnr9ubjg4it[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xg111cdi7ed9anuhh1pc2aldai9l"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.507309"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:06.507946"], ["updated_at", "2025-11-23 04:02:06.507946"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:06.508163"], ["updated_at", "2025-11-23 04:02:06.508163"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.509244"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.511313"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:06.512020"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.515865"], ["updated_at", "2025-11-23 04:02:06.515865"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0dbg0rry1n82425hciqwhf0ehop2"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.517615"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.517826"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:06.518541"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 0dbg0rry1n82425hciqwhf0ehop2[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lnvci3eb3dq4i29vos238otog2sz"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.520796"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:06.521112"], ["updated_at", "2025-11-23 04:02:06.521112"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:06.521299"], ["updated_at", "2025-11-23 04:02:06.521299"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.522190"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.523671"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:06.524386"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.525288"], ["updated_at", "2025-11-23 04:02:06.525288"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0elntdvsaw73wop78ubqvkonomvj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:06.526788"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:06.527018"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.531707"], ["updated_at", "2025-11-23 04:02:06.531707"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.542495"], ["updated_at", "2025-11-23 04:02:06.542495"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.543856"], ["updated_at", "2025-11-23 04:02:06.543856"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 04:02:06.546491"], ["updated_at", "2025-11-23 04:02:06.546491"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.548519"], ["updated_at", "2025-11-23 04:02:06.548519"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.549249"], ["updated_at", "2025-11-23 04:02:06.549249"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.550118"], ["updated_at", "2025-11-23 04:02:06.550118"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:06.551104"], ["updated_at", "2025-11-23 04:02:06.551104"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:11.616687', '2025-11-23 04:02:11.616689') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:11.640579', '2025-11-23 04:02:11.640580') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "a2wabymgqyxr37v55clm5fzcgvzp"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.681077"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.684071"], ["updated_at", "2025-11-23 04:02:11.684071"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.692288"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.693485"], ["updated_at", "2025-11-23 04:02:11.693485"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4rr6eeif0qkopvu0rr8h2xx0hnv5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.694824"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.695059"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:11.695945"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 4rr6eeif0qkopvu0rr8h2xx0hnv5[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tmlrhh2wlxm3d84lhu8gnoxwqt86"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.707102"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:11.707781"], ["updated_at", "2025-11-23 04:02:11.707781"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:11.708003"], ["updated_at", "2025-11-23 04:02:11.708003"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.709094"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.711030"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:11.711727"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.715153"], ["updated_at", "2025-11-23 04:02:11.715153"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "40whfk7hez9jnl6dlqotsjw32rwx"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.716536"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.716752"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:11.717453"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 40whfk7hez9jnl6dlqotsjw32rwx[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rqkoln97a4sett38tg9b2ae4n1aq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.719559"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:11.719838"], ["updated_at", "2025-11-23 04:02:11.719838"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:11.720023"], ["updated_at", "2025-11-23 04:02:11.720023"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.720877"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.722358"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:11.723009"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.723870"], ["updated_at", "2025-11-23 04:02:11.723870"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p1rlx3psdr0yfpfr8tnyvooz9wp8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:11.725314"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:11.725535"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.729198"], ["updated_at", "2025-11-23 04:02:11.729198"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.739072"], ["updated_at", "2025-11-23 04:02:11.739072"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.740382"], ["updated_at", "2025-11-23 04:02:11.740382"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 04:02:11.743002"], ["updated_at", "2025-11-23 04:02:11.743002"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.744933"], ["updated_at", "2025-11-23 04:02:11.744933"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.745646"], ["updated_at", "2025-11-23 04:02:11.745646"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.746559"], ["updated_at", "2025-11-23 04:02:11.746559"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:11.747543"], ["updated_at", "2025-11-23 04:02:11.747543"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:15.737085', '2025-11-23 04:02:15.737087') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:15.760889', '2025-11-23 04:02:15.760890') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xt4boztvob5hsqcrmdpbqiugxwx0"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.802071"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.805362"], ["updated_at", "2025-11-23 04:02:15.805362"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.813325"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.814537"], ["updated_at", "2025-11-23 04:02:15.814537"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tegdm9c3d7byghg70o7on3c9ycng"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.815969"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.816205"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:15.817109"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: tegdm9c3d7byghg70o7on3c9ycng[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "fyu7xpppkc2rcv2xqdlloh7x375a"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.820198"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:15.829223"], ["updated_at", "2025-11-23 04:02:15.829223"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:15.829792"], ["updated_at", "2025-11-23 04:02:15.829792"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.831021"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.832766"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:15.833950"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.837333"], ["updated_at", "2025-11-23 04:02:15.837333"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jn5rggyd42jy7585nhousqh9z8sv"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.839351"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.839596"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:15.840360"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: jn5rggyd42jy7585nhousqh9z8sv[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "kbgki7wshonswqlgtcpl41w2fkbk"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.842255"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 04:02:15.842519"], ["updated_at", "2025-11-23 04:02:15.842519"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 04:02:15.842709"], ["updated_at", "2025-11-23 04:02:15.842709"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.843563"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.845038"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 04:02:15.845728"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.846755"], ["updated_at", "2025-11-23 04:02:15.846755"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9o5or8f4c4ze83l9hw7xfn3c3l4a"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:02:15.848277"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 04:02:15.848498"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.852331"], ["updated_at", "2025-11-23 04:02:15.852331"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.862260"], ["updated_at", "2025-11-23 04:02:15.862260"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.863498"], ["updated_at", "2025-11-23 04:02:15.863498"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 04:02:15.866159"], ["updated_at", "2025-11-23 04:02:15.866159"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.868189"], ["updated_at", "2025-11-23 04:02:15.868189"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.869074"], ["updated_at", "2025-11-23 04:02:15.869074"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.870026"], ["updated_at", "2025-11-23 04:02:15.870026"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 04:02:15.871078"], ["updated_at", "2025-11-23 04:02:15.871078"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:20.939354', '2025-11-23 04:02:20.939356') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:20.963033', '2025-11-23 04:02:20.963035') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:33.354889', '2025-11-23 04:02:33.354890') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:33.385718', '2025-11-23 04:02:33.385720') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:44.057328', '2025-11-23 04:02:44.057329') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:02:44.080455', '2025-11-23 04:02:44.080456') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:03:13.878345', '2025-11-23 04:03:13.878346') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:03:13.912529', '2025-11-23 04:03:13.912531') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:04:43.576505', '2025-11-23 04:04:43.576507') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:04:43.609795', '2025-11-23 04:04:43.609796') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:05:50.196299', '2025-11-23 04:05:50.196301') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:05:50.234868', '2025-11-23 04:05:50.234870') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:05:50.280550"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [854e7b70-8e37-4d24-8739-a1c647630a09] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 854e7b70-8e37-4d24-8739-a1c647630a09) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [854e7b70-8e37-4d24-8739-a1c647630a09] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [854e7b70-8e37-4d24-8739-a1c647630a09]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [854e7b70-8e37-4d24-8739-a1c647630a09] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 854e7b70-8e37-4d24-8739-a1c647630a09) from Test(default) in 0.96ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (1.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:17:41.351326', '2025-11-23 04:17:41.351328') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 04:17:41.387709', '2025-11-23 04:17:41.387710') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 04:17:41.433326"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [44c20cf8-c837-42ee-9a5d-d76409ac3a52] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 44c20cf8-c837-42ee-9a5d-d76409ac3a52) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [44c20cf8-c837-42ee-9a5d-d76409ac3a52] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [44c20cf8-c837-42ee-9a5d-d76409ac3a52]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [44c20cf8-c837-42ee-9a5d-d76409ac3a52] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 44c20cf8-c837-42ee-9a5d-d76409ac3a52) from Test(default) in 0.84ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (2.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:07.184437', '2025-11-23 13:56:07.184438') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:07.215692', '2025-11-23 13:56:07.215693') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:07.255268"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [73f31531-98e6-4fe8-92a0-0a5895d13421] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 73f31531-98e6-4fe8-92a0-0a5895d13421) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [73f31531-98e6-4fe8-92a0-0a5895d13421] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [73f31531-98e6-4fe8-92a0-0a5895d13421]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [73f31531-98e6-4fe8-92a0-0a5895d13421] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 73f31531-98e6-4fe8-92a0-0a5895d13421) from Test(default) in 0.86ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:07.260632"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:07.260964"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:46:07.261186"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [9cd62e2d-22d1-4179-8454-94c59f9fbefb] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 9cd62e2d-22d1-4179-8454-94c59f9fbefb) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [9cd62e2d-22d1-4179-8454-94c59f9fbefb] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [9cd62e2d-22d1-4179-8454-94c59f9fbefb]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [9cd62e2d-22d1-4179-8454-94c59f9fbefb] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 9cd62e2d-22d1-4179-8454-94c59f9fbefb) from Test(default) in 0.29ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:07.262137"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:07.262388"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:46:07.262597"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:56:07.264752"], ["updated_at", "2025-11-23 13:56:07.264752"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:56:07.264950"], ["updated_at", "2025-11-23 13:56:07.264950"]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 13:56:07.269439"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 13:56:07.270468"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [04e04661-7e50-4871-95c5-2643b0b215c9] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 04e04661-7e50-4871-95c5-2643b0b215c9) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [04e04661-7e50-4871-95c5-2643b0b215c9] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [04e04661-7e50-4871-95c5-2643b0b215c9]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [04e04661-7e50-4871-95c5-2643b0b215c9] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 04e04661-7e50-4871-95c5-2643b0b215c9) from Test(default) in 0.3ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:07.274439"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:07.274726"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:46:07.274948"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:56:07.275211"], ["updated_at", "2025-11-23 13:56:07.275211"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:56:07.275399"], ["updated_at", "2025-11-23 13:56:07.275399"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 13:56:07.275559"], ["updated_at", "2025-11-23 13:56:07.275559"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:07.275803"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 13:56:07.276304"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 13:56:07.276781"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [16f8fb4f-de41-4994-98e6-56a1651fcabd] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 16f8fb4f-de41-4994-98e6-56a1651fcabd) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [16f8fb4f-de41-4994-98e6-56a1651fcabd] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [16f8fb4f-de41-4994-98e6-56a1651fcabd]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [16f8fb4f-de41-4994-98e6-56a1651fcabd] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 16f8fb4f-de41-4994-98e6-56a1651fcabd) from Test(default) in 0.27ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:07.277928"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:07.278200"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:46:07.278441"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a9124664-e94c-4c77-9ef8-0a25973c47d8] Performing ActiveStorageDedup::DeduplicationJob (Job ID: a9124664-e94c-4c77-9ef8-0a25973c47d8) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a9124664-e94c-4c77-9ef8-0a25973c47d8] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a9124664-e94c-4c77-9ef8-0a25973c47d8]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a9124664-e94c-4c77-9ef8-0a25973c47d8] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: a9124664-e94c-4c77-9ef8-0a25973c47d8) from Test(default) in 0.27ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:07.279514"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:07.279782"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:07.280034"], ["updated_at", "2025-11-23 13:56:07.280034"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 13:56:07.280274"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2456dab4-c6ad-49ba-85d8-6153beac49d9] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 2456dab4-c6ad-49ba-85d8-6153beac49d9) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2456dab4-c6ad-49ba-85d8-6153beac49d9] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2456dab4-c6ad-49ba-85d8-6153beac49d9]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2456dab4-c6ad-49ba-85d8-6153beac49d9] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 2456dab4-c6ad-49ba-85d8-6153beac49d9) from Test(default) in 0.33ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:30.364615', '2025-11-23 13:56:30.364617') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:30.393917', '2025-11-23 13:56:30.393918') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:56:30.431051"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:26:30.433717"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e3061403-7a6c-4e3c-a26a-04422edf790f] Performing ActiveStorageDedup::DeduplicationJob (Job ID: e3061403-7a6c-4e3c-a26a-04422edf790f) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e3061403-7a6c-4e3c-a26a-04422edf790f] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e3061403-7a6c-4e3c-a26a-04422edf790f]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e3061403-7a6c-4e3c-a26a-04422edf790f] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: e3061403-7a6c-4e3c-a26a-04422edf790f) from Test(default) in 3.18ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (1.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:53.263701', '2025-11-23 13:56:53.263703') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.5ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:56:53.432788', '2025-11-23 13:56:53.432791') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ffxyhdaiakhj2bvvj73ahq037jzt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.498420"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.502739"], ["updated_at", "2025-11-23 13:56:53.502739"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.514642"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.516279"], ["updated_at", "2025-11-23 13:56:53.516279"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "we59m1aomly66fxfaz9in45c4i5r"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.518133"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.518470"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 13:56:53.520191"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: we59m1aomly66fxfaz9in45c4i5r[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "v1f9xi9hzjyx28bg7me9qc9xp4ff"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.523726"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:56:53.524028"], ["updated_at", "2025-11-23 13:56:53.524028"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:56:53.524243"], ["updated_at", "2025-11-23 13:56:53.524243"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.525263"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.527286"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 13:56:53.528323"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.532357"], ["updated_at", "2025-11-23 13:56:53.532357"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2mdm4e8ryu57z4698c0ad3wyde7k"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.533894"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.534145"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 13:56:53.534916"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 2mdm4e8ryu57z4698c0ad3wyde7k[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9vbi0qwaehflv9ypbo2b7z5wbfae"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.536371"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:56:53.545970"], ["updated_at", "2025-11-23 13:56:53.545970"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:56:53.546313"], ["updated_at", "2025-11-23 13:56:53.546313"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.547632"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.548944"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 13:56:53.550105"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.551222"], ["updated_at", "2025-11-23 13:56:53.551222"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "trair7nau0k8zfs92hthkeetfgey"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:56:53.553082"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:56:53.553339"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.559557"], ["updated_at", "2025-11-23 13:56:53.559557"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.572747"], ["updated_at", "2025-11-23 13:56:53.572747"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "a25hpnd3dnkuaqvtvoglv1x5fxaj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.573642"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.574979"], ["updated_at", "2025-11-23 13:56:53.574979"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "q90xge67xthmezyf2jxv9dk1f0j7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.575663"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "udrgwr5uc0an11ftv0mezwg53l9j"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.576345"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 13:56:53.578954"], ["updated_at", "2025-11-23 13:56:53.578954"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dcsbnrq2wwoqmhdb5x0ezxkfuuii"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.579555"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6kmxacx5jyffovp6rf3d9aq06ac6"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.580138"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7y2dbs257njq9lfav7l9136wacih"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.581263"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.586041"], ["updated_at", "2025-11-23 13:56:53.586041"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b23hbfce6ijmnrkgr68g2cukvi6z"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.586462"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.587095"], ["updated_at", "2025-11-23 13:56:53.587095"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "w9a7ca2m639mg53bj3qsogwgx48q"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.587473"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.588329"], ["updated_at", "2025-11-23 13:56:53.588329"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5j8p19sdnzqrdk6mxplllwnk1g25"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.588999"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:56:53.589575"], ["updated_at", "2025-11-23 13:56:53.589575"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "qpj4rmbahc85gztwilazc4gbogqm"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 13:56:53.590312"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:18.216496', '2025-11-23 13:58:18.216498') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:18.249832', '2025-11-23 13:58:18.249833') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:58:18.288418"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b64f58a5-1a70-4f2d-8cc0-34f504e95ace] Performing ActiveStorageDedup::DeduplicationJob (Job ID: b64f58a5-1a70-4f2d-8cc0-34f504e95ace) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b64f58a5-1a70-4f2d-8cc0-34f504e95ace] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b64f58a5-1a70-4f2d-8cc0-34f504e95ace] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b64f58a5-1a70-4f2d-8cc0-34f504e95ace] Performed ActiveStorageDedup::DeduplicationJob (Job ID: b64f58a5-1a70-4f2d-8cc0-34f504e95ace) from Test(default) in 0.53ms
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.302433"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.302750"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:18.302971"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] Performing ActiveStorageDedup::DeduplicationJob (Job ID: fcac740a-9267-4ecc-a143-9677ea13a057) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fcac740a-9267-4ecc-a143-9677ea13a057] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: fcac740a-9267-4ecc-a143-9677ea13a057) from Test(default) in 0.34ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.304135"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.304396"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:18.304635"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:58:18.306980"], ["updated_at", "2025-11-23 13:58:18.306980"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:58:18.307177"], ["updated_at", "2025-11-23 13:58:18.307177"]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 13:58:18.311962"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 13:58:18.312506"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] Performing ActiveStorageDedup::DeduplicationJob (Job ID: fe35d87e-d701-4150-a065-7e9e3a29da36) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe35d87e-d701-4150-a065-7e9e3a29da36] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: fe35d87e-d701-4150-a065-7e9e3a29da36) from Test(default) in 0.29ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.316360"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.316636"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:18.316878"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:58:18.317326"], ["updated_at", "2025-11-23 13:58:18.317326"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:58:18.317514"], ["updated_at", "2025-11-23 13:58:18.317514"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 13:58:18.317683"], ["updated_at", "2025-11-23 13:58:18.317683"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:58:18.317932"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 13:58:18.318460"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 13:58:18.318926"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 67710e31-0cf6-43b1-bb67-140751eea1ea) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [67710e31-0cf6-43b1-bb67-140751eea1ea] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 67710e31-0cf6-43b1-bb67-140751eea1ea) from Test(default) in 0.24ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.320058"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.320335"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:18.320568"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] Performing ActiveStorageDedup::DeduplicationJob (Job ID: ba2b73c6-2332-4dad-bec7-5c422e900438) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ba2b73c6-2332-4dad-bec7-5c422e900438] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: ba2b73c6-2332-4dad-bec7-5c422e900438) from Test(default) in 0.26ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.321781"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.322056"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 13:58:18.322465"], ["updated_at", "2025-11-23 13:58:18.322465"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 13:58:18.322702"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] Performing ActiveStorageDedup::DeduplicationJob (Job ID: c6aa0cde-5c72-4e52-abbe-a17b43e00119) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c6aa0cde-5c72-4e52-abbe-a17b43e00119] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: c6aa0cde-5c72-4e52-abbe-a17b43e00119) from Test(default) in 8.02ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:18.335243"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:18.335751"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6a36414e-d705-4f35-bfc1-f60164ffc4b8] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 6a36414e-d705-4f35-bfc1-f60164ffc4b8) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6a36414e-d705-4f35-bfc1-f60164ffc4b8] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6a36414e-d705-4f35-bfc1-f60164ffc4b8] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6a36414e-d705-4f35-bfc1-f60164ffc4b8] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 6a36414e-d705-4f35-bfc1-f60164ffc4b8) from Test(default) in 0.09ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:42.327586', '2025-11-23 13:58:42.327588') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:42.358507', '2025-11-23 13:58:42.358508') RETURNING "key"[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:47.020107', '2025-11-23 13:58:47.020108') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:47.040375', '2025-11-23 13:58:47.040376') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:47.072648"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:47.075242"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:47.075483"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] Performing ActiveStorageDedup::DeduplicationJob (Job ID: b4cc0052-65c5-4fb8-be6d-f95fbec00b93) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b4cc0052-65c5-4fb8-be6d-f95fbec00b93] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: b4cc0052-65c5-4fb8-be6d-f95fbec00b93) from Test(default) in 3.61ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:47.083014"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:47.083328"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:47.083549"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:58:47.085886"], ["updated_at", "2025-11-23 13:58:47.085886"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:58:47.086100"], ["updated_at", "2025-11-23 13:58:47.086100"]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 13:58:47.090969"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 13:58:47.091600"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] Performing ActiveStorageDedup::DeduplicationJob (Job ID: fe30cda3-fd40-434b-82c4-e189f3670c21) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [fe30cda3-fd40-434b-82c4-e189f3670c21] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: fe30cda3-fd40-434b-82c4-e189f3670c21) from Test(default) in 0.34ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:47.095684"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:47.095990"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:47.096208"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 13:58:47.096670"], ["updated_at", "2025-11-23 13:58:47.096670"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 13:58:47.096856"], ["updated_at", "2025-11-23 13:58:47.096856"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 13:58:47.097029"], ["updated_at", "2025-11-23 13:58:47.097029"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 13:58:47.097259"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 13:58:47.097795"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 13:58:47.098263"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 58c1e1b9-fcc2-4ae5-99c1-a3d5cd811e5f) from Test(default) in 0.25ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:47.099368"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:47.099650"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:47.099886"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] Performing ActiveStorageDedup::DeduplicationJob (Job ID: f551cd79-eba8-4424-a7ea-4d733de233d8) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f551cd79-eba8-4424-a7ea-4d733de233d8] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: f551cd79-eba8-4424-a7ea-4d733de233d8) from Test(default) in 0.24ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:57.521380', '2025-11-23 13:58:57.521382') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:58:57.549392', '2025-11-23 13:58:57.549393') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:58:57.585218"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:28:57.587824"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:48:57.588069"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 64215eb5-944d-45e5-9132-f8f7e3450487) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [64215eb5-944d-45e5-9132-f8f7e3450487] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 64215eb5-944d-45e5-9132-f8f7e3450487) from Test(default) in 3.55ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:59:11.746042', '2025-11-23 13:59:11.746044') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:59:11.775718', '2025-11-23 13:59:11.775719') RETURNING "key"[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:59:46.155984', '2025-11-23 13:59:46.155986') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 13:59:46.185159', '2025-11-23 13:59:46.185160') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 12:59:46.220353"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:29:46.223065"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:49:46.223303"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 68a9f193-f9c2-4201-bfb6-b9a90daaab16) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [68a9f193-f9c2-4201-bfb6-b9a90daaab16] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 68a9f193-f9c2-4201-bfb6-b9a90daaab16) from Test(default) in 3.58ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:02.419747', '2025-11-23 14:00:02.419749') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:02.449765', '2025-11-23 14:00:02.449767') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:00:02.484862"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:30:02.487617"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:50:02.487890"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 7ca192f4-8463-4447-b1ab-822b07f25717) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] [ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [7ca192f4-8463-4447-b1ab-822b07f25717] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 7ca192f4-8463-4447-b1ab-822b07f25717) from Test(default) in 0.78ms: NoMethodError (undefined method 'size' for nil):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:23.463232', '2025-11-23 14:00:23.463234') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:23.494852', '2025-11-23 14:00:23.494854') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:00:23.530103"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:30:23.532879"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:50:23.533128"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" IS NULL ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="]]
[ActiveStorageDedup] Found 0 blob(s) with checksum lHP90NiApDwht...
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:58.351447', '2025-11-23 14:00:58.351448') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:00:58.380150', '2025-11-23 14:00:58.380151') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:00:58.415174"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:30:58.417850"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:50:58.418086"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:12.184132', '2025-11-23 14:01:12.184134') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:12.217819', '2025-11-23 14:01:12.217821') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:01:12.262305"]]
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 78bb3bed-1b68-4d2f-97f2-c8e6cf2f7e53) from Test(default) in 0.65ms
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.270346"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.270881"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:12.271156"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 3c5810c9-3e83-4903-9278-158518d68cef) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3c5810c9-3e83-4903-9278-158518d68cef] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 3c5810c9-3e83-4903-9278-158518d68cef) from Test(default) in 7.31ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.282081"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.282581"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:12.282848"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:01:12.285672"], ["updated_at", "2025-11-23 14:01:12.285672"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:01:12.286006"], ["updated_at", "2025-11-23 14:01:12.286006"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:01:12.288795"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:01:12.289443"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 96560f90-747c-4ad0-b8ff-5c644afbd122) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Updated keeper 1 reference_count to 2
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [96560f90-747c-4ad0-b8ff-5c644afbd122] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 96560f90-747c-4ad0-b8ff-5c644afbd122) from Test(default) in 1.34ms
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.294327"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.294721"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:12.294989"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:01:12.295505"], ["updated_at", "2025-11-23 14:01:12.295505"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:01:12.295709"], ["updated_at", "2025-11-23 14:01:12.295709"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:01:12.295894"], ["updated_at", "2025-11-23 14:01:12.295894"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:01:12.296181"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:01:12.296762"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:01:12.297238"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 6e1147c8-364b-4502-bd68-3ccda4ed1f9b) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Updated keeper 1 reference_count to 2
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Updated keeper 1 reference_count to 3
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6e1147c8-364b-4502-bd68-3ccda4ed1f9b] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 6e1147c8-364b-4502-bd68-3ccda4ed1f9b) from Test(default) in 11.72ms
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.310190"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.310642"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:12.310874"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] Performing ActiveStorageDedup::DeduplicationJob (Job ID: ac81fe4d-d42c-4493-b30c-d137e925155f) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ac81fe4d-d42c-4493-b30c-d137e925155f] Performed ActiveStorageDedup::DeduplicationJob (Job ID: ac81fe4d-d42c-4493-b30c-d137e925155f) from Test(default) in 1.82ms
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.324169"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.324723"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:01:12.325350"], ["updated_at", "2025-11-23 14:01:12.325350"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:01:12.325691"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] Performing ActiveStorageDedup::DeduplicationJob (Job ID: f936dca6-b123-40ee-8e6f-d48fa3c61592) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f936dca6-b123-40ee-8e6f-d48fa3c61592] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: f936dca6-b123-40ee-8e6f-d48fa3c61592) from Test(default) in 0.56ms: StandardError (Test error):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:12.330651"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:12.331004"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [faa2709b-c842-47a6-bab5-6dfac47364e9] Performing ActiveStorageDedup::DeduplicationJob (Job ID: faa2709b-c842-47a6-bab5-6dfac47364e9) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [faa2709b-c842-47a6-bab5-6dfac47364e9] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [faa2709b-c842-47a6-bab5-6dfac47364e9] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [faa2709b-c842-47a6-bab5-6dfac47364e9] Performed ActiveStorageDedup::DeduplicationJob (Job ID: faa2709b-c842-47a6-bab5-6dfac47364e9) from Test(default) in 0.07ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:33.643798', '2025-11-23 14:01:33.643799') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:33.665288', '2025-11-23 14:01:33.665290') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:01:33.702129"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [69492810-8bd5-4500-9ce2-2040aae3b42a] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 69492810-8bd5-4500-9ce2-2040aae3b42a) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [69492810-8bd5-4500-9ce2-2040aae3b42a] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [69492810-8bd5-4500-9ce2-2040aae3b42a] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [69492810-8bd5-4500-9ce2-2040aae3b42a] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 69492810-8bd5-4500-9ce2-2040aae3b42a) from Test(default) in 0.4ms
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.708556"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.708964"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:33.709218"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 4e051d1a-abe0-4b9a-9ecd-a1c348201d8d) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4e051d1a-abe0-4b9a-9ecd-a1c348201d8d] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 4e051d1a-abe0-4b9a-9ecd-a1c348201d8d) from Test(default) in 6.01ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.718371"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.718730"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:33.718959"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:01:33.721176"], ["updated_at", "2025-11-23 14:01:33.721176"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:01:33.721394"], ["updated_at", "2025-11-23 14:01:33.721394"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:01:33.723539"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:01:33.724013"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 3a9714f7-05a9-4a06-815a-11048d841423) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Updated keeper 1 reference_count to 2
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [3a9714f7-05a9-4a06-815a-11048d841423] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 3a9714f7-05a9-4a06-815a-11048d841423) from Test(default) in 1.19ms
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.728233"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.728525"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:33.728756"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:01:33.729184"], ["updated_at", "2025-11-23 14:01:33.729184"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:01:33.729362"], ["updated_at", "2025-11-23 14:01:33.729362"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:01:33.729530"], ["updated_at", "2025-11-23 14:01:33.729530"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:01:33.729779"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:01:33.730288"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:01:33.730749"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 4a1fca89-6c42-4772-9056-f945d5ee402c) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Updated keeper 1 reference_count to 2
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Updated keeper 1 reference_count to 3
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4a1fca89-6c42-4772-9056-f945d5ee402c] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 4a1fca89-6c42-4772-9056-f945d5ee402c) from Test(default) in 10.02ms
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.741839"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.742221"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:33.742450"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] Performing ActiveStorageDedup::DeduplicationJob (Job ID: e078d184-b38b-4a85-8c37-4fca89d9f39e) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [e078d184-b38b-4a85-8c37-4fca89d9f39e] Performed ActiveStorageDedup::DeduplicationJob (Job ID: e078d184-b38b-4a85-8c37-4fca89d9f39e) from Test(default) in 1.62ms
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.754937"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.755309"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:01:33.755840"], ["updated_at", "2025-11-23 14:01:33.755840"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:01:33.756128"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 50f825fb-910e-467c-af8c-a52f3931240d) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [50f825fb-910e-467c-af8c-a52f3931240d] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 50f825fb-910e-467c-af8c-a52f3931240d) from Test(default) in 0.54ms: StandardError (Test error):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:33.761364"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:33.761757"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [55ffe2b4-861b-4983-8ac3-68726ee689d8] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 55ffe2b4-861b-4983-8ac3-68726ee689d8) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [55ffe2b4-861b-4983-8ac3-68726ee689d8] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [55ffe2b4-861b-4983-8ac3-68726ee689d8] [ActiveStorageDedup] âœ“ No duplicate blobs found - database is clean!
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [55ffe2b4-861b-4983-8ac3-68726ee689d8] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 55ffe2b4-861b-4983-8ac3-68726ee689d8) from Test(default) in 0.06ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:38.625372', '2025-11-23 14:01:38.625374') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:38.646921', '2025-11-23 14:01:38.646923') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:38.671945"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:38.674748"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:38.675002"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] Performing ActiveStorageDedup::DeduplicationJob (Job ID: da91c69c-c45a-49cc-9b60-10a5d80893d1) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Merging blob 3 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] [ActiveStorageDedup] âœ“ Sanity check complete - merged 2 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [da91c69c-c45a-49cc-9b60-10a5d80893d1] Performed ActiveStorageDedup::DeduplicationJob (Job ID: da91c69c-c45a-49cc-9b60-10a5d80893d1) from Test(default) in 7.59ms
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:53.701178', '2025-11-23 14:01:53.701179') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:01:53.722075', '2025-11-23 14:01:53.722077') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:01:53.746887"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:31:53.749707"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:51:53.749957"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a4beec03-84c0-4bf0-af52-c161d35e9825] Performing ActiveStorageDedup::DeduplicationJob (Job ID: a4beec03-84c0-4bf0-af52-c161d35e9825) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a4beec03-84c0-4bf0-af52-c161d35e9825] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a4beec03-84c0-4bf0-af52-c161d35e9825]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a4beec03-84c0-4bf0-af52-c161d35e9825] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: a4beec03-84c0-4bf0-af52-c161d35e9825) from Test(default) in 2.33ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:23.955383', '2025-11-23 14:02:23.955385') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:23.985017', '2025-11-23 14:02:23.985018') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:24.020959"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:24.023955"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:24.024207"]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:38.101553', '2025-11-23 14:02:38.101563') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:38.130815', '2025-11-23 14:02:38.130816') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:38.167311"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:38.170246"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:38.170510"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:56.734859', '2025-11-23 14:02:56.734861') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:02:56.764631', '2025-11-23 14:02:56.764632') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:56.800148"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:56.802875"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:56.803139"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:56.815309"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:56.815600"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:56.815809"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:02:56.817759"], ["updated_at", "2025-11-23 14:02:56.817759"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:02:56.817973"], ["updated_at", "2025-11-23 14:02:56.817973"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:02:56.820048"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:02:56.820530"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8f0132d2-460c-4f4f-aaf3-d4f38ca8e162] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 8f0132d2-460c-4f4f-aaf3-d4f38ca8e162) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8f0132d2-460c-4f4f-aaf3-d4f38ca8e162] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8f0132d2-460c-4f4f-aaf3-d4f38ca8e162]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8f0132d2-460c-4f4f-aaf3-d4f38ca8e162] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 8f0132d2-460c-4f4f-aaf3-d4f38ca8e162) from Test(default) in 0.79ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:56.822957"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:56.823253"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:56.823462"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:02:56.823710"], ["updated_at", "2025-11-23 14:02:56.823710"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:02:56.823888"], ["updated_at", "2025-11-23 14:02:56.823888"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:02:56.824062"], ["updated_at", "2025-11-23 14:02:56.824062"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:02:56.824297"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:02:56.824809"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:02:56.825301"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6146a2ae-5731-46d3-8bff-6c125bd3150a] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 6146a2ae-5731-46d3-8bff-6c125bd3150a) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6146a2ae-5731-46d3-8bff-6c125bd3150a] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6146a2ae-5731-46d3-8bff-6c125bd3150a]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6146a2ae-5731-46d3-8bff-6c125bd3150a] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 6146a2ae-5731-46d3-8bff-6c125bd3150a) from Test(default) in 0.28ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:02:56.826469"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:32:56.826770"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:52:56.826992"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1f40e32a-32e8-428a-8e05-42d6617816e5] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 1f40e32a-32e8-428a-8e05-42d6617816e5) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1f40e32a-32e8-428a-8e05-42d6617816e5] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1f40e32a-32e8-428a-8e05-42d6617816e5]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1f40e32a-32e8-428a-8e05-42d6617816e5] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 1f40e32a-32e8-428a-8e05-42d6617816e5) from Test(default) in 0.27ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:03:21.622897', '2025-11-23 14:03:21.622898') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:03:21.652493', '2025-11-23 14:03:21.652494') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:21.693613"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:21.696384"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:21.696635"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:21.709882"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:21.710263"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:21.710498"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:03:21.712653"], ["updated_at", "2025-11-23 14:03:21.712653"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:03:21.712875"], ["updated_at", "2025-11-23 14:03:21.712875"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:03:21.715236"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:03:21.715743"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1c4f1ef6-4c07-48ee-acef-49e108466abe] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 1c4f1ef6-4c07-48ee-acef-49e108466abe) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1c4f1ef6-4c07-48ee-acef-49e108466abe] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1c4f1ef6-4c07-48ee-acef-49e108466abe]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [1c4f1ef6-4c07-48ee-acef-49e108466abe] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 1c4f1ef6-4c07-48ee-acef-49e108466abe) from Test(default) in 0.79ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:21.718203"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:21.718505"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:21.718732"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:03:21.718993"], ["updated_at", "2025-11-23 14:03:21.718993"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:03:21.719170"], ["updated_at", "2025-11-23 14:03:21.719170"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:03:21.719340"], ["updated_at", "2025-11-23 14:03:21.719340"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:03:21.719576"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:03:21.720085"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:03:21.720578"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4cce693f-ec47-4cbf-9652-d96a1dd264fb] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 4cce693f-ec47-4cbf-9652-d96a1dd264fb) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4cce693f-ec47-4cbf-9652-d96a1dd264fb] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4cce693f-ec47-4cbf-9652-d96a1dd264fb]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [4cce693f-ec47-4cbf-9652-d96a1dd264fb] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 4cce693f-ec47-4cbf-9652-d96a1dd264fb) from Test(default) in 0.29ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:21.721769"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:21.722046"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:21.722292"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 88f0e24d-16ea-4c1f-b4b0-cd7fb7e9c34e) from Test(default) in 0.28ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:03:37.460972', '2025-11-23 14:03:37.460973') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:03:37.491757', '2025-11-23 14:03:37.491759') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:03:37.529246"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.534164"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.534486"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:37.534712"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.544557"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.544896"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:37.545141"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:03:37.547229"], ["updated_at", "2025-11-23 14:03:37.547229"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:03:37.547443"], ["updated_at", "2025-11-23 14:03:37.547443"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:03:37.549776"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:03:37.550293"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8846c998-5c00-46a8-8b62-270088378888] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 8846c998-5c00-46a8-8b62-270088378888) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8846c998-5c00-46a8-8b62-270088378888] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8846c998-5c00-46a8-8b62-270088378888]   [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [8846c998-5c00-46a8-8b62-270088378888] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: 8846c998-5c00-46a8-8b62-270088378888) from Test(default) in 0.84ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.552819"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.553101"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:37.553312"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:03:37.553577"], ["updated_at", "2025-11-23 14:03:37.553577"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:03:37.553760"], ["updated_at", "2025-11-23 14:03:37.553760"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:03:37.553935"], ["updated_at", "2025-11-23 14:03:37.553935"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:03:37.554165"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:03:37.554698"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:03:37.555161"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b33bfc02-219b-4d88-bdfa-e3beacfc7373] Performing ActiveStorageDedup::DeduplicationJob (Job ID: b33bfc02-219b-4d88-bdfa-e3beacfc7373) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b33bfc02-219b-4d88-bdfa-e3beacfc7373] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b33bfc02-219b-4d88-bdfa-e3beacfc7373]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [b33bfc02-219b-4d88-bdfa-e3beacfc7373] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: b33bfc02-219b-4d88-bdfa-e3beacfc7373) from Test(default) in 0.29ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.556346"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.556611"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:53:37.556843"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad] Performing ActiveStorageDedup::DeduplicationJob (Job ID: c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad]   [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad] Error performing ActiveStorageDedup::DeduplicationJob (Job ID: c84fb0ac-92f2-46c5-b07f-b2ea19fa00ad) from Test(default) in 0.28ms: ActiveRecord::StatementInvalid (SQLite3::SQLException: wrong number of arguments to function COUNT():
SELECT COUNT("active_storage_blobs"."checksum", "active_storage_blobs"."service_name") AS "count_active_storage_blobs_checksum_active_storage_blobs_service", "active_storage_blobs"."checksum", "active_storage_blobs"."service_name", "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1)
       ^):

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.557956"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.558225"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:03:37.568431"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:33:37.568960"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:04:55.461857', '2025-11-23 14:04:55.461859') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:04:55.491279', '2025-11-23 14:04:55.491280') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:04:55.527966"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.532704"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.533021"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:54:55.533237"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.539903"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.540184"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:54:55.540408"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:04:55.542370"], ["updated_at", "2025-11-23 14:04:55.542370"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:04:55.542574"], ["updated_at", "2025-11-23 14:04:55.542574"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:04:55.544906"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:04:55.545354"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.549450"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.549772"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:54:55.550009"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:04:55.550256"], ["updated_at", "2025-11-23 14:04:55.550256"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:04:55.550439"], ["updated_at", "2025-11-23 14:04:55.550439"]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:04:55.550605"], ["updated_at", "2025-11-23 14:04:55.550605"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:04:55.550894"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:04:55.551398"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:04:55.551836"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.553772"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.554070"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:54:55.554309"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.556044"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.556286"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:04:55.556553"], ["updated_at", "2025-11-23 14:04:55.556553"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:04:55.556821"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:04:55.572996"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:34:55.573467"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:12.396598', '2025-11-23 14:05:12.396600') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:12.425870', '2025-11-23 14:05:12.425871') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:12.462427"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.467070"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.467402"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:12.467643"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.473903"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.474170"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:12.474389"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:12.476421"], ["updated_at", "2025-11-23 14:05:12.476421"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:12.476641"], ["updated_at", "2025-11-23 14:05:12.476641"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:12.478684"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:05:12.479164"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.483134"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.483410"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:12.483627"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:12.483868"], ["updated_at", "2025-11-23 14:05:12.483868"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:12.484031"], ["updated_at", "2025-11-23 14:05:12.484031"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:05:12.484207"], ["updated_at", "2025-11-23 14:05:12.484207"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:12.484443"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:05:12.484921"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:05:12.485374"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.487241"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.487510"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:12.487741"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.489363"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.489647"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:12.489896"], ["updated_at", "2025-11-23 14:05:12.489896"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:12.490134"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:12.504205"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:12.504603"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:23.930880', '2025-11-23 14:05:23.930881') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:23.958889', '2025-11-23 14:05:23.958890') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:23.999990"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.004554"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.004853"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:24.005079"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.011603"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.011897"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:24.012117"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:24.014152"], ["updated_at", "2025-11-23 14:05:24.014152"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:24.014371"], ["updated_at", "2025-11-23 14:05:24.014371"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:24.016656"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:05:24.017123"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.021303"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.021637"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:24.021889"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:24.022165"], ["updated_at", "2025-11-23 14:05:24.022165"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:24.022341"], ["updated_at", "2025-11-23 14:05:24.022341"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:05:24.022508"], ["updated_at", "2025-11-23 14:05:24.022508"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.022741"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:05:24.023239"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:05:24.023717"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.025636"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.025935"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:24.026152"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.027826"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.028082"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.028357"], ["updated_at", "2025-11-23 14:05:24.028357"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:24.028594"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:24.043040"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:24.043453"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vi8u13wpbx5uj52ajwretkpzhfoq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.045251"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.045694"], ["updated_at", "2025-11-23 14:05:24.045694"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.049416"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.050331"], ["updated_at", "2025-11-23 14:05:24.050331"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mnlgnxrejz8hqu1j02d5i1jdffde"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.051988"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.052213"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:24.053247"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: mnlgnxrejz8hqu1j02d5i1jdffde[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "skl9jf77832zrcmvajcw97qj6k39"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.054990"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:24.055248"], ["updated_at", "2025-11-23 14:05:24.055248"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:24.055428"], ["updated_at", "2025-11-23 14:05:24.055428"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.056219"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.057566"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:24.058227"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.061322"], ["updated_at", "2025-11-23 14:05:24.061322"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0ok1h3ph4n91thg4tbyhwa49v6mg"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.062786"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.062997"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:24.063679"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 0ok1h3ph4n91thg4tbyhwa49v6mg[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s98tfsxw3kuou9bju31l7guv3bl4"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.065035"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:24.065458"], ["updated_at", "2025-11-23 14:05:24.065458"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:24.065623"], ["updated_at", "2025-11-23 14:05:24.065623"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.066443"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.067501"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:24.068181"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.069181"], ["updated_at", "2025-11-23 14:05:24.069181"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "kj7immvsn5lune04dee6g3sjbqu1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:24.070433"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:24.070642"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.072588"], ["updated_at", "2025-11-23 14:05:24.072588"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.083791"], ["updated_at", "2025-11-23 14:05:24.083791"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "v0x30x7jmmc3xog6lwqh3v2b33z0"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.084478"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.085483"], ["updated_at", "2025-11-23 14:05:24.085483"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1jjpouhfw4zr9xryv737bx5a6h2e"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.086085"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pb5jywed32ryww4rk8vw33vmb868"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.086703"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:05:24.088933"], ["updated_at", "2025-11-23 14:05:24.088933"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rdtcr2eqgvezoqmqbq9efnz6ukf7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.089432"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rt98svq7tybr2r9d8i1sv9cckofr"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.089944"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "sj5s7sk3ofc3fun3sbxeztksk35h"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.090957"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.093460"], ["updated_at", "2025-11-23 14:05:24.093460"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "i3e7xol7oupud08s2clymcgefd8t"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.093789"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.094275"], ["updated_at", "2025-11-23 14:05:24.094275"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "gp1n9xn5nxn4ucvqpngjcm5c0m6s"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.094599"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.095378"], ["updated_at", "2025-11-23 14:05:24.095378"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b9dmeo8vhvb261y9cif9wn08y060"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.095970"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:24.096492"], ["updated_at", "2025-11-23 14:05:24.096492"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "krtz04hgd510bttqmke22snxww8y"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:24.097122"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:31.472199', '2025-11-23 14:05:31.472201') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:31.492497', '2025-11-23 14:05:31.492498') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.522322"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.525767"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.526077"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:31.526325"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.531987"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.532305"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:31.532525"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:31.534470"], ["updated_at", "2025-11-23 14:05:31.534470"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:31.534703"], ["updated_at", "2025-11-23 14:05:31.534703"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:31.536741"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:05:31.537217"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.540998"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.541277"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:31.541495"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:31.541768"], ["updated_at", "2025-11-23 14:05:31.541768"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:31.541940"], ["updated_at", "2025-11-23 14:05:31.541940"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:05:31.542108"], ["updated_at", "2025-11-23 14:05:31.542108"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.542364"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:05:31.542861"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:05:31.543341"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.554441"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.554830"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:31.555064"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.557176"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.557453"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.557702"], ["updated_at", "2025-11-23 14:05:31.557702"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:31.557977"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:31.562627"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:31.562940"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "inawxxpjv8wor9ydqjsmrzi27n34"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.564609"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.565071"], ["updated_at", "2025-11-23 14:05:31.565071"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.567825"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.568722"], ["updated_at", "2025-11-23 14:05:31.568722"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vqvejurgpwxhq9pkqoo2nvxr8nwz"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.570005"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.570217"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:31.571150"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: vqvejurgpwxhq9pkqoo2nvxr8nwz[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pqfg3xt86tgqokd9y0ggi9d5k5i7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.572607"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:31.572848"], ["updated_at", "2025-11-23 14:05:31.572848"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:31.573015"], ["updated_at", "2025-11-23 14:05:31.573015"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.573921"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.575130"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:31.575912"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.578410"], ["updated_at", "2025-11-23 14:05:31.578410"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dtxrxe3wl0rv2zplrrc3y5nvohre"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.579791"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.579989"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:31.580630"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dtxrxe3wl0rv2zplrrc3y5nvohre[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "awktgx4itg4gnq896jo2a5xjpvi8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.581944"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:31.582301"], ["updated_at", "2025-11-23 14:05:31.582301"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:31.582463"], ["updated_at", "2025-11-23 14:05:31.582463"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.583243"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.584305"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:31.585031"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.585802"], ["updated_at", "2025-11-23 14:05:31.585802"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ex43148s5vlba9p2ricoctiuv0ww"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:31.586984"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:31.587188"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.588738"], ["updated_at", "2025-11-23 14:05:31.588738"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.596798"], ["updated_at", "2025-11-23 14:05:31.596798"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "j4vbxxw8ttjttk8qwo9czc4pzt91"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.597459"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.598446"], ["updated_at", "2025-11-23 14:05:31.598446"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hhyz0moenblquqhpyx67lqtkjbpj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.599034"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "r1305t5do7pli7jfr4yew1pn3o9q"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.599640"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:05:31.601793"], ["updated_at", "2025-11-23 14:05:31.601793"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4ara4syqjk6x5xs3fdvy96ec4xgd"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.602341"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7u1yqixyhqk02m7a4smmg6qsd0ev"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.602874"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8suqx8bkzmremf0tif0ypqpygd6x"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.603883"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.606024"], ["updated_at", "2025-11-23 14:05:31.606024"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "puijudzs8qv09aly9oh97gr2xjd3"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.606361"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.606884"], ["updated_at", "2025-11-23 14:05:31.606884"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b4si6ojbtgcq8onc4se7u231j8ke"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.607228"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.607984"], ["updated_at", "2025-11-23 14:05:31.607984"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "gntellpc9u6v7izsgkae9bahzy7e"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.608573"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:31.609106"], ["updated_at", "2025-11-23 14:05:31.609106"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vjlkgt7tg14c4wmorxhytabsxfp7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:31.609768"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:37.064552', '2025-11-23 14:05:37.064553') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:37.085285', '2025-11-23 14:05:37.085286') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.116607"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.119898"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.120266"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:37.120500"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.126163"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.126459"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:37.126684"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:37.128568"], ["updated_at", "2025-11-23 14:05:37.128568"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:37.128787"], ["updated_at", "2025-11-23 14:05:37.128787"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:37.130711"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:05:37.131181"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.134897"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.135193"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:37.135412"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:37.135695"], ["updated_at", "2025-11-23 14:05:37.135695"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:37.135863"], ["updated_at", "2025-11-23 14:05:37.135863"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:05:37.136033"], ["updated_at", "2025-11-23 14:05:37.136033"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.136285"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:05:37.136780"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:05:37.137241"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.147686"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.148044"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:55:37.148267"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.150317"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.150586"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.150848"], ["updated_at", "2025-11-23 14:05:37.150848"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:05:37.151117"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:05:37.155751"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:35:37.156045"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pz2osevevc87q4u38vgx2tz64ub9"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.157815"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.158268"], ["updated_at", "2025-11-23 14:05:37.158268"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.160924"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.161787"], ["updated_at", "2025-11-23 14:05:37.161787"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ojkw9z5d4vrjrtp6sutcnflejonl"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.163064"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.163410"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:37.164250"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: ojkw9z5d4vrjrtp6sutcnflejonl[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mi2sexau5gfxgwik276g487bqh6d"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.165704"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:37.165950"], ["updated_at", "2025-11-23 14:05:37.165950"]]
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:37.166128"], ["updated_at", "2025-11-23 14:05:37.166128"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.167066"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.168311"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:37.169114"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.171615"], ["updated_at", "2025-11-23 14:05:37.171615"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7hcg8whsjnlg8b96r1uveo3zw50a"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.173007"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.173211"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:37.173863"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 7hcg8whsjnlg8b96r1uveo3zw50a[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3hu1hhwzxby9a0gn0a4am6hlhpjj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.175187"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:37.175425"], ["updated_at", "2025-11-23 14:05:37.175425"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:37.175721"], ["updated_at", "2025-11-23 14:05:37.175721"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.176514"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.177568"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:37.178207"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.179095"], ["updated_at", "2025-11-23 14:05:37.179095"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "kmcupvi3e9xgmo79483u6se3zcta"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:37.180295"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:37.180497"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.182117"], ["updated_at", "2025-11-23 14:05:37.182117"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.190281"], ["updated_at", "2025-11-23 14:05:37.190281"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "oonfyepxkoixu7sfhmdufylq07lp"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.190946"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.191936"], ["updated_at", "2025-11-23 14:05:37.191936"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wba67684z3s2pqi5ospbbr3e1evh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.192535"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "na2sm70etw2fjh7ltc09tn1817ck"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.193156"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:05:37.195143"], ["updated_at", "2025-11-23 14:05:37.195143"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "09ykmny6m7xynd36jtecv4gjb264"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.195681"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ykcb6e4v24mce1mtz6vca9t5i52n"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.196224"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xlq3aoam62wjihl98fupcbrv4fp5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.197224"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.199320"], ["updated_at", "2025-11-23 14:05:37.199320"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ymqveih7ck3yig0pywrigz0nl5by"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.199671"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.200208"], ["updated_at", "2025-11-23 14:05:37.200208"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "risbim9voqiw6hr4azouzwm9ph7o"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.200557"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.201344"], ["updated_at", "2025-11-23 14:05:37.201344"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "48t9pomckavsaz381u4x49yhe959"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.201958"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:05:37.202515"], ["updated_at", "2025-11-23 14:05:37.202515"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "urrblb6yk1y87ltree163047m42w"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:05:37.203170"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:43.232958', '2025-11-23 14:05:43.232960') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:43.253889', '2025-11-23 14:05:43.253889') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "brfjbr66msanyv5wcxogtliiks4t"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:43.283055"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:43.285136"], ["updated_at", "2025-11-23 14:05:43.285136"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:43.285374"], ["updated_at", "2025-11-23 14:05:43.285374"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:43.292371"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:43.294013"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:43.294823"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:54.081261', '2025-11-23 14:05:54.081263') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:05:54.109714', '2025-11-23 14:05:54.109716') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jve7vsj5oaw9i0a00e7syf04a4df"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:05:54.147914"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:05:54.150099"], ["updated_at", "2025-11-23 14:05:54.150099"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:05:54.150331"], ["updated_at", "2025-11-23 14:05:54.150331"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:05:54.158159"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:05:54.159951"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:05:54.160784"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:13.833247', '2025-11-23 14:06:13.833249') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:13.863515', '2025-11-23 14:06:13.863516') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "d2qiaw0kg3hlmk1d789ixj3jwff1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:06:13.901810"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:06:13.909032"], ["updated_at", "2025-11-23 14:06:13.909032"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:06:13.909288"], ["updated_at", "2025-11-23 14:06:13.909288"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:06:13.914519"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:06:13.916794"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:06:13.918238"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:40.240969', '2025-11-23 14:06:40.240970') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:40.268659', '2025-11-23 14:06:40.268660') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ywlu0fa97u9junrb0uctrci4k0vz"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:06:40.306467"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:06:40.308635"], ["updated_at", "2025-11-23 14:06:40.308635"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:06:40.308877"], ["updated_at", "2025-11-23 14:06:40.308877"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:06:40.317156"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:06:40.319296"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:57.555079', '2025-11-23 14:06:57.555081') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:06:57.584456', '2025-11-23 14:06:57.584457') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:06:57.618418"], ["updated_at", "2025-11-23 14:06:57.618418"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "woktd1g4qf6497y0y79d3jwj0cyy"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:06:57.632336"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:06:57.632632"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:08.529477', '2025-11-23 14:07:08.529480') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:08.558492', '2025-11-23 14:07:08.558493') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yai4365arz9dxsqlk71ykcuhwuld"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.598055"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:08.601214"], ["updated_at", "2025-11-23 14:07:08.601214"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.609392"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:08.610604"], ["updated_at", "2025-11-23 14:07:08.610604"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1f06c6fndl5et3fs54egfxcdlald"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.611970"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.612195"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:07:08.613093"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 1f06c6fndl5et3fs54egfxcdlald[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yypr00nwgcj81s55f1azixyufqea"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.616029"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:07:08.616286"], ["updated_at", "2025-11-23 14:07:08.616286"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:07:08.616467"], ["updated_at", "2025-11-23 14:07:08.616467"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.617307"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.618989"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:08.620453"], ["updated_at", "2025-11-23 14:07:08.620453"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "gxz59l2tjcq9drj1lptqqpetn1ys"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.621664"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.621876"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:07:08.622544"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: gxz59l2tjcq9drj1lptqqpetn1ys[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9r0scwvxbwp105602m7qocieomyw"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.623917"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:07:08.624170"], ["updated_at", "2025-11-23 14:07:08.624170"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:07:08.624350"], ["updated_at", "2025-11-23 14:07:08.624350"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.625139"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.626208"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:08.627667"], ["updated_at", "2025-11-23 14:07:08.627667"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "peurw19d1ajaouhmgtp0gv9c78gd"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:07:08.637528"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:07:08.637799"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:13.869462', '2025-11-23 14:07:13.869464') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:13.889797', '2025-11-23 14:07:13.889798') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.921000"], ["updated_at", "2025-11-23 14:07:13.921000"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.945227"], ["updated_at", "2025-11-23 14:07:13.945227"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rgbbb9tn2hmucjf1zp3hyrftw8p5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.946302"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.947842"], ["updated_at", "2025-11-23 14:07:13.947842"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s6tl52jww93ocwluulo14xp6rrbs"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.948557"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5cvmkhqc8koy6plfg3tcl54qicw1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.949270"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:07:13.951636"], ["updated_at", "2025-11-23 14:07:13.951636"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5mr1f76fckm4px4f4p43hhyfcg4m"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.952293"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hsbsfnmvp2di36jw3a0i2w6zduj2"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.952917"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6xzayepeds3p7sxnf86ay23tyl9v"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.954178"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.962642"], ["updated_at", "2025-11-23 14:07:13.962642"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8idr01fmjdzql3ckupgg5bc836u5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.963230"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.963822"], ["updated_at", "2025-11-23 14:07:13.963822"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "em30kzi91t427ircv8dzzy2pc56c"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.964192"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.964975"], ["updated_at", "2025-11-23 14:07:13.964975"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wqasb6k5y6jq87ofxsel5y39x1l7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.965689"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:07:13.966212"], ["updated_at", "2025-11-23 14:07:13.966212"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4j857krcl8r0aiupqcpjyp6gb8np"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:13.967086"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:52.759043', '2025-11-23 14:07:52.759044') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:07:52.790695', '2025-11-23 14:07:52.790696') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pg8zu130l3z8zb70cld60w1dgjkw"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:07:52.835728"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:08:28.262513', '2025-11-23 14:08:28.262515') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:08:28.297167', '2025-11-23 14:08:28.297168') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.336090"], ["updated_at", "2025-11-23 14:08:28.336090"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wcupjylbzpofwtpt0uk1rqhe422r"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.345313"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.346283"], ["updated_at", "2025-11-23 14:08:28.346283"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1z8mz6ivt7rilzpz49ki6kfeng9s"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.346972"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.348134"], ["updated_at", "2025-11-23 14:08:28.348134"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8qcopzlto45jxj5ov26lw69iayz8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.348776"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mlz2ps6rrk0d70bv4ve1ffai68um"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.349430"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:08:28.351673"], ["updated_at", "2025-11-23 14:08:28.351673"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "072rtn94a9o321u36f71po3iccji"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.352234"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "izb5omezq1a6whaz0wvc5yo8kl0e"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.352793"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "j2s7cllylztjk57x698z2o5ykuvv"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.353881"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.356545"], ["updated_at", "2025-11-23 14:08:28.356545"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cmtvs0aq74h3ixzjxf7uaghh89c4"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.356955"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.357558"], ["updated_at", "2025-11-23 14:08:28.357558"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "bqmomsu0ijfwipl400jxj1gj7sja"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.357912"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.358734"], ["updated_at", "2025-11-23 14:08:28.358734"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s8984vtcyt5hf2hrqad681fuhsq0"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.359369"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:28.359942"], ["updated_at", "2025-11-23 14:08:28.359942"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wnxyjsbbeqgbbztnau1anqfgu2at"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:28.360592"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:08:38.182620', '2025-11-23 14:08:38.182621') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:08:38.203328', '2025-11-23 14:08:38.203329') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.241110"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.245729"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.246067"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:58:38.246286"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.252619"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.252928"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:58:38.253155"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:08:38.255181"], ["updated_at", "2025-11-23 14:08:38.255181"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:08:38.255378"], ["updated_at", "2025-11-23 14:08:38.255378"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:08:38.257702"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:08:38.258184"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.262324"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.262618"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:58:38.262858"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:08:38.263131"], ["updated_at", "2025-11-23 14:08:38.263131"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:08:38.263318"], ["updated_at", "2025-11-23 14:08:38.263318"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:08:38.263519"], ["updated_at", "2025-11-23 14:08:38.263519"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.263759"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:08:38.264314"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:08:38.264823"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (9.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.1ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.277335"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.277811"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:58:38.278034"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.280157"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.280410"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.280689"], ["updated_at", "2025-11-23 14:08:38.280689"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:08:38.280979"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:08:38.286983"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:38:38.287278"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wpolsd3h6jegs5fbp046vza9p09o"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.289026"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.289493"], ["updated_at", "2025-11-23 14:08:38.289493"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.292475"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.293330"], ["updated_at", "2025-11-23 14:08:38.293330"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "aux3ct0wfelof8tyssi36szh8lgn"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.294770"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.294986"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:08:38.295860"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: aux3ct0wfelof8tyssi36szh8lgn[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ur5kykv3bmsex3xiugsinydhovnc"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.297335"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:08:38.297679"], ["updated_at", "2025-11-23 14:08:38.297679"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:08:38.297851"], ["updated_at", "2025-11-23 14:08:38.297851"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.298686"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.299909"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.301462"], ["updated_at", "2025-11-23 14:08:38.301462"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3r00c404etrgde7b8cwgl4p9268y"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.302686"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.302885"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:08:38.303569"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 3r00c404etrgde7b8cwgl4p9268y[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hpa9arr0m2k739t2db3hd7yxl8ne"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.305038"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:08:38.305281"], ["updated_at", "2025-11-23 14:08:38.305281"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:08:38.305458"], ["updated_at", "2025-11-23 14:08:38.305458"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.306251"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.307419"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.308842"], ["updated_at", "2025-11-23 14:08:38.308842"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5ph88826ufd0sd4bf0v61b9c0zik"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:08:38.310224"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:08:38.310432"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.311832"], ["updated_at", "2025-11-23 14:08:38.311832"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "srxsmr9vzyhhthkrrwxcttle89xb"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.314869"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.315504"], ["updated_at", "2025-11-23 14:08:38.315504"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ko0l5g9smv2olivo7bl4t2ts2dbr"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.316134"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.317104"], ["updated_at", "2025-11-23 14:08:38.317104"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xhwijta4id2av7nort5wsjvw7xbi"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.317696"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "x5pkq7z8e7j56uo8pl5s4z1etzga"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.318310"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:08:38.320424"], ["updated_at", "2025-11-23 14:08:38.320424"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "k7cactaqli3mlb28w170szl2l84m"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.320967"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uxypv7s4eodfos3f0zslh9q4u854"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.321557"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xrq92sp5fmoe7p9km4cfs2nmbnav"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.322575"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.323661"], ["updated_at", "2025-11-23 14:08:38.323661"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "zhehfj16iy43cd6o5punmtycasfc"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.324002"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.324527"], ["updated_at", "2025-11-23 14:08:38.324527"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "e3s9vah4a6wjhebb3lwelz4fse2h"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.324866"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.325627"], ["updated_at", "2025-11-23 14:08:38.325627"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "c8r75xcx7cwvq22h3tdsy68480li"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.326250"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:08:38.326774"], ["updated_at", "2025-11-23 14:08:38.326774"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "85wosg7ar9glywpvoy65ta2ghntl"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:08:38.327407"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:10:41.826919', '2025-11-23 14:10:41.826920') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 14:10:41.856303', '2025-11-23 14:10:41.856304') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.905672"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.910803"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.911388"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:00:41.911614"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.918800"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.919077"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:00:41.919309"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:10:41.921586"], ["updated_at", "2025-11-23 14:10:41.921586"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:10:41.921800"], ["updated_at", "2025-11-23 14:10:41.921800"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:10:41.924349"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 14:10:41.924823"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.929137"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.929437"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:00:41.929663"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:10:41.930049"], ["updated_at", "2025-11-23 14:10:41.930049"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:10:41.930231"], ["updated_at", "2025-11-23 14:10:41.930231"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 14:10:41.930408"], ["updated_at", "2025-11-23 14:10:41.930408"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.930644"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 14:10:41.931138"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 14:10:41.931601"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.933552"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.933838"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:00:41.934068"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.935799"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.936059"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.936340"], ["updated_at", "2025-11-23 14:10:41.936340"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 14:10:41.936572"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:10:41.943018"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 13:40:41.943356"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ogruwwpa6v7gxz9ec7nazvjj4js6"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.944839"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.945290"], ["updated_at", "2025-11-23 14:10:41.945290"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.948377"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.949258"], ["updated_at", "2025-11-23 14:10:41.949258"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ggd4cp6solpoe8dbsikhyhmi01k1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.950498"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.950697"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:10:41.951670"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: ggd4cp6solpoe8dbsikhyhmi01k1[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cd9rptrmmd8l5ky43dgwh0thb4uy"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.953021"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:10:41.953245"], ["updated_at", "2025-11-23 14:10:41.953245"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:10:41.953408"], ["updated_at", "2025-11-23 14:10:41.953408"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.954190"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.955413"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.956777"], ["updated_at", "2025-11-23 14:10:41.956777"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ojh2sw0sc4p8v5g6icz0ah9jc2ki"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.957983"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.958189"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 14:10:41.958838"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: ojh2sw0sc4p8v5g6icz0ah9jc2ki[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s9wfdc2borq89ncha4nrhpa5nxj7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.960106"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 14:10:41.960347"], ["updated_at", "2025-11-23 14:10:41.960347"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 14:10:41.960517"], ["updated_at", "2025-11-23 14:10:41.960517"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.961300"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.962392"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.963807"], ["updated_at", "2025-11-23 14:10:41.963807"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "g1r6ge20c15yytawiguuapojzp6o"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 14:10:41.965026"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 14:10:41.965225"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.966621"], ["updated_at", "2025-11-23 14:10:41.966621"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "odkfgl7qhthac2xb8j5hpijagzav"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.969670"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.970201"], ["updated_at", "2025-11-23 14:10:41.970201"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "sm3o9tq7z2cea3e923c61qimqroz"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.970799"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.971716"], ["updated_at", "2025-11-23 14:10:41.971716"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tork4q5nf2j3sz2xzm39mi852kxc"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.972352"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "t30ysay2q3020gf0k36014nffxc8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.973020"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 14:10:41.975358"], ["updated_at", "2025-11-23 14:10:41.975358"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yx3hssje9qrl1vgpo5bkzagg3ned"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.975970"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b4mmwjoa0ahjhj9t27n8mkzaziyq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.976522"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xo28d6n3yekt9x6nu2hu048jmwlk"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.977618"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.978706"], ["updated_at", "2025-11-23 14:10:41.978706"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xnc7kkgg2enu0qijlerk1qzfnmr7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.979106"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.979648"], ["updated_at", "2025-11-23 14:10:41.979648"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9cblf8r3slknplv0czzfu6n1pq7e"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.980025"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.980801"], ["updated_at", "2025-11-23 14:10:41.980801"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "l3bm3zigunfjhyyegogagb2v6lb1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.981437"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 14:10:41.981994"], ["updated_at", "2025-11-23 14:10:41.981994"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "akfr93j3saozgvnu79pbp7xzqig6"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 14:10:41.982642"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 23:56:20.950403', '2025-11-23 23:56:20.950404') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 23:56:20.980204', '2025-11-23 23:56:20.980205') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.020556"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.024987"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.025308"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:21.025529"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.2ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.031700"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.031989"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:21.032203"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:21.034569"], ["updated_at", "2025-11-23 23:56:21.034569"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:21.034788"], ["updated_at", "2025-11-23 23:56:21.034788"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 23:56:21.037351"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 23:56:21.037827"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.041801"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.042092"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:21.042303"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:21.042563"], ["updated_at", "2025-11-23 23:56:21.042563"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:21.042751"], ["updated_at", "2025-11-23 23:56:21.042751"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 23:56:21.042926"], ["updated_at", "2025-11-23 23:56:21.042926"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.043163"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 23:56:21.043668"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 23:56:21.044140"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.045950"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.046208"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:21.046442"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.048088"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.048367"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.048626"], ["updated_at", "2025-11-23 23:56:21.048626"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 23:56:21.048867"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:21.053883"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:21.054148"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5g84itfswpm2jna6goccvudmz43j"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.055563"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.055996"], ["updated_at", "2025-11-23 23:56:21.055996"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.058674"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.059525"], ["updated_at", "2025-11-23 23:56:21.059525"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "v58ess7iygn2ofjjnsh5gvqi2zh1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.060779"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.060987"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 23:56:21.061891"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: v58ess7iygn2ofjjnsh5gvqi2zh1[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xcc80n1v703708sd7rx50qw3ny1p"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.063353"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:21.063608"], ["updated_at", "2025-11-23 23:56:21.063608"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:21.063787"], ["updated_at", "2025-11-23 23:56:21.063787"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.064576"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.065816"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.067258"], ["updated_at", "2025-11-23 23:56:21.067258"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "12eponae8bo7b6hkf147wja5s85h"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.068474"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.068677"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 23:56:21.069343"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 12eponae8bo7b6hkf147wja5s85h[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "itnt0zz548fqnuy8pvfoyx2efst4"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.070618"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:21.070853"], ["updated_at", "2025-11-23 23:56:21.070853"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:21.071029"], ["updated_at", "2025-11-23 23:56:21.071029"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.071837"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.072922"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.074334"], ["updated_at", "2025-11-23 23:56:21.074334"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "zt6ecjxxqk7omqq98xd3v15ef4yf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:21.075558"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:21.075763"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.077160"], ["updated_at", "2025-11-23 23:56:21.077160"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "877zsu2keak1zfm0lpsm5otegc2y"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.080029"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.080633"], ["updated_at", "2025-11-23 23:56:21.080633"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ph6q2aynrn2ejiu0tzvb5c6qv054"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.081233"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.082172"], ["updated_at", "2025-11-23 23:56:21.082172"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "l555q0vdx8waddv5uji9kkoe4n5j"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.082789"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "rh99ta66s5bzf3yoe6ponjihop86"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.083395"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 23:56:21.085570"], ["updated_at", "2025-11-23 23:56:21.085570"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pmh778scogzcqhhuw39h8slhk3yf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.086072"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "x4d7t2o9usl1a45x8etiecebsui9"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.086594"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wiow6sta8o9enk5p931otjes203o"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.087586"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.088660"], ["updated_at", "2025-11-23 23:56:21.088660"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "asb7b34320f60cujznd6bfbb16zp"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.088992"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.089522"], ["updated_at", "2025-11-23 23:56:21.089522"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uxgvbosuck99k02z7xgz6gy42s0s"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.089863"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.099082"], ["updated_at", "2025-11-23 23:56:21.099082"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pivfaehr62h5hdrsp784qadaml81"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.099814"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:21.100436"], ["updated_at", "2025-11-23 23:56:21.100436"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "onwo6dfvcdge1uuncjfsyl5qtt1o"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:21.101444"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.7ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 23:56:42.071436', '2025-11-23 23:56:42.071438') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-23 23:56:42.099404', '2025-11-23 23:56:42.099405') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.163950"]]
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.170443"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.171007"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:42.171285"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.178535"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.179090"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:42.179320"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:42.181578"], ["updated_at", "2025-11-23 23:56:42.181578"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:42.181808"], ["updated_at", "2025-11-23 23:56:42.181808"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 23:56:42.184089"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-23 23:56:42.184568"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.188916"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.189342"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:42.189573"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:42.189839"], ["updated_at", "2025-11-23 23:56:42.189839"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:42.190009"], ["updated_at", "2025-11-23 23:56:42.190009"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-23 23:56:42.190180"], ["updated_at", "2025-11-23 23:56:42.190180"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.190422"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-23 23:56:42.190922"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-23 23:56:42.191386"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.193428"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.193714"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:46:42.193945"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.195757"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.196018"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.196289"], ["updated_at", "2025-11-23 23:56:42.196289"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-23 23:56:42.196556"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 22:56:42.204091"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:26:42.204552"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "slacax6zooiuaqkvtkiqhpcwr3k2"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.206131"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.206625"], ["updated_at", "2025-11-23 23:56:42.206625"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.210726"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.211729"], ["updated_at", "2025-11-23 23:56:42.211729"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "y2ikps4a4bumnio36erb0kysveby"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.213082"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.213305"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 23:56:42.214505"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: y2ikps4a4bumnio36erb0kysveby[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ut7el3xfzo94xgmmfvf7cjitooyh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.216675"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:42.216988"], ["updated_at", "2025-11-23 23:56:42.216988"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:42.217169"], ["updated_at", "2025-11-23 23:56:42.217169"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.218081"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.219412"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.220921"], ["updated_at", "2025-11-23 23:56:42.220921"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hydfydl3t9md7pgvey9nfcxszd8x"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.222193"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.222405"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-23 23:56:42.223095"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: hydfydl3t9md7pgvey9nfcxszd8x[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "tr9qfi7u7wkyky3tlrxkxr37nubh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.224466"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-23 23:56:42.224709"], ["updated_at", "2025-11-23 23:56:42.224709"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-23 23:56:42.224888"], ["updated_at", "2025-11-23 23:56:42.224888"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.225695"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.226837"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.228328"], ["updated_at", "2025-11-23 23:56:42.228328"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5fzoqxvd6v63un8a45iuq395o9uf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:56:42.229640"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-23 23:56:42.229855"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.231423"], ["updated_at", "2025-11-23 23:56:42.231423"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "726k7hfwdc5d467mf41dh1h6zcs0"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.235172"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.235825"], ["updated_at", "2025-11-23 23:56:42.235825"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "sw3whvyauhg66mvrt4bjpo767yzx"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.236464"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.237438"], ["updated_at", "2025-11-23 23:56:42.237438"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "wjzl4jbkg7fnxthqi022cclna7do"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.238052"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cu6lyg504eucl4r40f6ip7utv8vn"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.238691"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-23 23:56:42.240794"], ["updated_at", "2025-11-23 23:56:42.240794"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "reatz6ev2x0cie9z7zhntijl6nk5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.241355"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ivzzw987zs7m219vchlchymtxvkl"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.241910"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yqzws5a2bnfc1q54k1nvuhs1kkdr"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.242961"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.244082"], ["updated_at", "2025-11-23 23:56:42.244082"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p2hr8tzggfs81il5shsbuen7fhfl"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.244437"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.244976"], ["updated_at", "2025-11-23 23:56:42.244976"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "67d2eicvskjhlf3b07ilogvg9sam"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.245335"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.246150"], ["updated_at", "2025-11-23 23:56:42.246150"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0uxo6abo24tku10rmy7h0yzbqbon"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.246767"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-23 23:56:42.247305"], ["updated_at", "2025-11-23 23:56:42.247305"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "aewjh2rm6qhj85m48bqtc3t99xp4"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-23 23:56:42.247967"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:01:15.463168', '2025-11-24 00:01:15.463169') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:01:15.502312', '2025-11-24 00:01:15.502313') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:01:15.551866"]]
  [1m[36mActiveStorage::Blob Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:01:15.556406"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:31:15.556841"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT checksum, service_name, COUNT(*) as blob_count FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Blob Count (0.2ms)[0m  [1m[34mSELECT COUNT(checksum, service_name, COUNT(*) as blob_count) AS "count_checksum_service_name_count_all_as_blob_count", checksum, service_name, COUNT(*) as blob_count, "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:01:15.566151"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:31:15.566619"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT checksum, service_name, COUNT(*) as blob_count FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(checksum, service_name, COUNT(*) as blob_count) AS "count_checksum_service_name_count_all_as_blob_count", checksum, service_name, COUNT(*) as blob_count, "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:01:15.568323"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:01:15.568617"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:01:15.568828"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:01:15.569031"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:01:15.569245"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT checksum, service_name, COUNT(*) as blob_count FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Blob Count (0.1ms)[0m  [1m[34mSELECT COUNT(checksum, service_name, COUNT(*) as blob_count) AS "count_checksum_service_name_count_all_as_blob_count", checksum, service_name, COUNT(*) as blob_count, "active_storage_blobs"."checksum" AS "active_storage_blobs_checksum", "active_storage_blobs"."service_name" AS "active_storage_blobs_service_name" FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) ORDER BY blob_count DESC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:01:15.575598"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:31:15.576148"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] Performing ActiveStorageDedup::DeduplicationJob (Job ID: c702a443-aa3a-488e-923f-c03b626f02ca) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [c702a443-aa3a-488e-923f-c03b626f02ca] Performed ActiveStorageDedup::DeduplicationJob (Job ID: c702a443-aa3a-488e-923f-c03b626f02ca) from Test(default) in 1.72ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:01:15.579705"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:01:15.584312"], ["updated_at", "2025-11-24 00:01:15.584312"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:01:15.584623"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:01:15.585155"]]
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", nil], ["id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:01:15.585776"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:01:15.586154"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:01:15.586379"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:01:15.586671"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:01:15.586876"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:01:15.587177"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:01:15.587387"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:01:15.587696"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:01:15.587901"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:01:15.588199"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:01:15.588418"]]
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:01:15.597900"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:01:15.598323"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:01:15.598664"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:01:15.598876"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:01:15.599162"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:01:15.599369"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:01:15.599656"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:01:15.599870"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:01:15.600168"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:01:15.600378"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:01:15.601023"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:01:15.601244"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:01:15.601523"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:01:15.601744"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:01:15.602028"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:01:15.602250"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:01:15.602540"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:01:15.602762"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:01:15.603062"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:01:15.603656"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:01:15.603958"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:01:15.604187"]]
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.5ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:01:15.605263"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:01:15.610874"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:01:15.611695"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:01:15.611971"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:01:15.612304"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:01:15.612535"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:01:15.612848"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:01:15.613497"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:01:15.613811"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:01:15.614036"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:01:15.614341"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:01:15.614579"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:01:15.614974"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:01:15.615216"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:01:15.615534"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:01:15.615782"]]
  [1m[36mActiveStorage::Blob Update (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:01:15.616453"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:01:15.616697"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:01:15.617018"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:01:15.617285"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:01:15.617605"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:01:15.617831"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:01:15.618125"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:01:15.618325"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:01:15.618596"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:01:15.619026"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:01:15.619313"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:01:15.619522"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:01:15.619815"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:01:15.620031"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:01:15.620321"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:01:15.620538"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:01:15.620830"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:01:15.621048"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:01:15.621336"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:01:15.621714"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:01:15.622004"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:01:15.622232"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:01:15.622538"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:01:15.622764"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:01:15.623078"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:01:15.623304"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:01:15.623608"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:01:15.623816"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:01:15.624117"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:01:15.624452"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:01:15.624786"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:01:15.624997"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:01:15.625301"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:01:15.625526"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:01:15.625828"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:01:15.626050"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:01:15.626347"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:01:15.626566"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:01:15.626861"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:01:15.627234"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:01:15.627753"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:01:15.628423"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:01:15.628971"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:01:15.629956"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:01:15.630382"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:01:15.630647"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:01:15.630960"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:01:15.631177"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:01:15.631684"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:01:15.631908"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:01:15.632222"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:01:15.632434"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:01:15.632751"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:01:15.632973"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:01:15.633294"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:01:15.633517"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:01:15.633821"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:01:15.634047"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:01:15.634354"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:01:15.634732"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:01:15.635037"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:01:15.635276"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:01:15.635630"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:01:15.635864"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:01:15.636178"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:01:15.636417"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:01:15.636731"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:01:15.636961"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:01:15.637278"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:01:15.637507"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:01:15.637937"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:01:15.638167"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:01:15.638484"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:01:15.638713"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:01:15.639035"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:01:15.639267"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:01:15.639583"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:01:15.639816"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:01:15.640136"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:01:15.640506"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:01:15.640832"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:01:15.641065"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:01:15.641382"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:01:15.641612"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:01:15.641940"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:01:15.642173"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:01:15.642497"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:01:15.642734"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:01:15.643307"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:01:15.644148"]]
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:01:15.644705"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:01:15.645089"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:01:15.645544"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:01:15.645780"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:01:15.646117"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:01:15.646472"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:01:15.647000"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:01:15.647282"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:01:15.647946"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:01:15.648218"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:01:15.648572"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.3ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.1ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:01:15.683978"], ["updated_at", "2025-11-24 00:01:15.683978"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:01:15.684369"], ["updated_at", "2025-11-24 00:01:15.684369"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:01:15.684680"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.9ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:02:22.225824', '2025-11-24 00:02:22.225826') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:02:22.257027', '2025-11-24 00:02:22.257029') RETURNING "key"[0m
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:22.300776"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:22.304730"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:22.305047"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:22.316522"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:22.316904"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:02:22.318729"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:02:22.319017"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:02:22.319251"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:02:22.319468"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:02:22.319678"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:22.322515"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:22.322789"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] Performing ActiveStorageDedup::DeduplicationJob (Job ID: f291282b-7a5b-4c7d-8111-7852dd3eb504) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [f291282b-7a5b-4c7d-8111-7852dd3eb504] Performed ActiveStorageDedup::DeduplicationJob (Job ID: f291282b-7a5b-4c7d-8111-7852dd3eb504) from Test(default) in 1.36ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:22.325184"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:22.328267"], ["updated_at", "2025-11-24 00:02:22.328267"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uoy8r1khtbc1d31ju7lxmgtrgxg1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:22.329096"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.1ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:22.343377"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 5], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lfmzy6v4a53npx3n1coxfhqo84xv"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:22.346085"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:02:22.347649"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:02:22.348002"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:02:22.348210"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:02:22.348503"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:02:22.348706"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:02:22.348998"]]
  [1m[36mActiveStorage::Blob Create (0.4ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:02:22.349201"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:02:22.349844"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:02:22.350054"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:02:22.350347"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:02:22.350553"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:02:22.350837"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:02:22.351044"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:02:22.351336"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:02:22.351541"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:02:22.351833"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:02:22.352040"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:02:22.352639"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:02:22.352857"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:02:22.353165"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:02:22.353387"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:02:22.353674"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:02:22.353890"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:02:22.354188"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:02:22.354403"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:02:22.354691"]]
  [1m[36mActiveStorage::Blob Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:02:22.354904"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:02:22.355371"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:02:22.355586"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:02:22.355877"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:02:22.356082"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:02:22.356380"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:02:22.356586"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:02:22.356913"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:02:22.357125"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:02:22.357446"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:02:22.357812"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:02:22.358101"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:02:22.358315"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:02:22.358608"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:02:22.358823"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:02:22.359111"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:02:22.359325"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:02:22.359616"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:02:22.359835"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:02:22.360119"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:02:22.360458"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:02:22.360743"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:02:22.360957"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:02:22.361248"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:02:22.361460"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:02:22.361748"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:02:22.362007"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:02:22.362294"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:02:22.362515"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:02:22.362805"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:02:22.363170"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:02:22.363460"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:02:22.363664"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:02:22.363952"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:02:22.364167"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:02:22.364456"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:02:22.364670"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:02:22.364960"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:02:22.365172"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:02:22.365462"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:02:22.365675"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:02:22.365969"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:02:22.366176"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.3ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:02:22.366470"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:02:22.366913"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:02:22.367201"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:02:22.367414"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:02:22.367706"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:02:22.367928"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:02:22.368219"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:02:22.368430"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:02:22.368719"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:02:22.368931"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:02:22.369347"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:02:22.369554"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:02:22.369847"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:02:22.370060"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:02:22.370373"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:02:22.370588"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:02:22.370885"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:02:22.371089"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:02:22.371381"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:02:22.371595"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:02:22.371889"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:02:22.372235"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:02:22.372526"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:02:22.372736"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:02:22.373034"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:02:22.373246"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:02:22.373542"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:02:22.373755"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:02:22.374044"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:02:22.374257"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:02:22.374546"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:02:22.374758"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:02:22.375050"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:02:22.375263"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:02:22.375723"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:02:22.375940"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:02:22.376229"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:02:22.376446"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:02:22.376735"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:02:22.376948"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:02:22.377239"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:02:22.377454"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:02:22.377749"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:02:22.377968"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:02:22.378260"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:02:22.378480"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:02:22.378782"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:02:22.379003"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:02:22.379295"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:02:22.379591"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:02:22.379882"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:02:22.380096"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:02:22.380385"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:02:22.380598"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:02:22.380896"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:02:22.381110"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:02:22.381405"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:02:22.381622"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:02:22.381915"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:02:22.382135"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:02:22.382424"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:02:22.382632"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:02:22.382984"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:02:22.383206"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:02:22.383508"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:02:22.383727"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:02:22.384020"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:02:22.384233"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:02:22.384522"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:02:22.384737"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:02:22.385031"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:02:22.385296"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:02:22.385596"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:02:22.385810"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:02:22.386099"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:02:22.386314"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:02:22.386607"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:02:22.386827"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:02:22.387133"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:02:22.387351"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:02:22.387666"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:22.415506"], ["updated_at", "2025-11-24 00:02:22.415506"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:22.415752"], ["updated_at", "2025-11-24 00:02:22.415752"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7w6xf6oogvgwota03orvm7j7prn1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:22.416423"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:22.417510"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:02:22.418685"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 2], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.6ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:02:29.506818', '2025-11-24 00:02:29.506819') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:02:29.527956', '2025-11-24 00:02:29.527958') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.560842"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.564198"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.564527"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:52:29.564748"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.570301"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.570618"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:52:29.570836"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:29.572794"], ["updated_at", "2025-11-24 00:02:29.572794"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:29.573011"], ["updated_at", "2025-11-24 00:02:29.573011"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:02:29.575032"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-24 00:02:29.575525"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.579328"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.579639"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:52:29.579871"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:29.580142"], ["updated_at", "2025-11-24 00:02:29.580142"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:29.588227"], ["updated_at", "2025-11-24 00:02:29.588227"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-24 00:02:29.588452"], ["updated_at", "2025-11-24 00:02:29.588452"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.588727"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-24 00:02:29.589321"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-24 00:02:29.589813"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.592282"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.592579"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:52:29.592805"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.4ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.594899"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.595165"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.595440"], ["updated_at", "2025-11-24 00:02:29.595440"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:02:29.595695"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.600324"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.600629"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "qq2smzl4jouw04b55h1qvgj78whm"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.602289"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.602736"], ["updated_at", "2025-11-24 00:02:29.602736"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.605470"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.606389"], ["updated_at", "2025-11-24 00:02:29.606389"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cghqc0xwvo28jpbptd8xecmluqnf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.607698"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.607917"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:02:29.609029"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: cghqc0xwvo28jpbptd8xecmluqnf[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0mq5uxtrmk2bb41zp3qsqet4olbt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.610525"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:29.610776"], ["updated_at", "2025-11-24 00:02:29.610776"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:29.610958"], ["updated_at", "2025-11-24 00:02:29.610958"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.611915"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.613187"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.614653"], ["updated_at", "2025-11-24 00:02:29.614653"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "apoufxdy0917e5cgp9gvpbz6pdhy"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.616085"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.616298"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:02:29.616976"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: apoufxdy0917e5cgp9gvpbz6pdhy[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "yelclm1ijfamyx4qq56byhra2p9g"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.618445"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:29.618692"], ["updated_at", "2025-11-24 00:02:29.618692"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:29.618876"], ["updated_at", "2025-11-24 00:02:29.618876"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.619674"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.620755"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.622325"], ["updated_at", "2025-11-24 00:02:29.622325"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5776ksq0jvhmhsvij7szj5ztfjel"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.623560"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.623786"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.625397"], ["updated_at", "2025-11-24 00:02:29.625397"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "y84fgbmox8p1um7xkcnl1a2z7llj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.628721"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.629291"], ["updated_at", "2025-11-24 00:02:29.629291"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "p79d3pukxizbud6e45rgf1fgsg2x"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.630011"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.631015"], ["updated_at", "2025-11-24 00:02:29.631015"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "a0w5hy9qd9p20i73lx98shdrvt1v"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.631630"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6mp4yoqznp31xij93541od1jns5s"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.632261"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-24 00:02:29.634456"], ["updated_at", "2025-11-24 00:02:29.634456"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5cns7z3towanufly35or7n5pejkf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.634991"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "343xcryf7jr1z6dbvs4enletm1ng"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.635527"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "g2goavq25dmpuhrtt4em1muezqjl"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.636557"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.637632"], ["updated_at", "2025-11-24 00:02:29.637632"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "nb9eiakntyjzinuxg3qtabluf7jm"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.638008"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.638539"], ["updated_at", "2025-11-24 00:02:29.638539"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "a20dnag9a6l5fwugu31h38mo5zx5"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.638874"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.639619"], ["updated_at", "2025-11-24 00:02:29.639619"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3q7e8hi50j3ob2saevovhrmieu42"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.640231"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.640737"], ["updated_at", "2025-11-24 00:02:29.640737"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "utc42yi29ndrstbf6kk1ns2shcmg"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:02:29.641398"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.643516"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.650473"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.650769"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.653293"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.653567"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:02:29.655082"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:02:29.655351"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:02:29.655574"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:02:29.655797"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:02:29.656026"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:02:29.658350"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:32:29.658597"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] Performing ActiveStorageDedup::DeduplicationJob (Job ID: a09d38ad-7c6b-40a3-8816-803446c7bcad) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [a09d38ad-7c6b-40a3-8816-803446c7bcad] Performed ActiveStorageDedup::DeduplicationJob (Job ID: a09d38ad-7c6b-40a3-8816-803446c7bcad) from Test(default) in 1.12ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.660517"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:02:29.661494"], ["updated_at", "2025-11-24 00:02:29.661494"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6n267riy5v79ns2mnl0st045pjzh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.662043"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.663045"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 5], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4p4imkju3k6v6ox1ax40g3dmtebv"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.664822"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:02:29.665994"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:02:29.666327"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:02:29.666549"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:02:29.666845"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:02:29.667060"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:02:29.667360"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:02:29.667577"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:02:29.667887"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:02:29.668111"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:02:29.668405"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:02:29.668620"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:02:29.668917"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:02:29.669125"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:02:29.669419"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:02:29.669648"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:02:29.669940"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:02:29.670155"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:02:29.670458"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:02:29.670666"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:02:29.670958"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:02:29.671176"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:02:29.671488"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:02:29.671698"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:02:29.671994"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:02:29.672211"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:02:29.672505"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:02:29.672721"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:02:29.673025"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:02:29.673260"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:02:29.673547"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:02:29.673762"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:02:29.674060"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:02:29.674282"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:02:29.674602"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:02:29.674829"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:02:29.675129"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:02:29.675365"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:02:29.675657"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:02:29.675877"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:02:29.676170"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:02:29.676388"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:02:29.676692"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:02:29.676917"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:02:29.677208"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:02:29.677429"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:02:29.677727"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:02:29.677945"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:02:29.678245"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:02:29.678463"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:02:29.678760"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:02:29.678979"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:02:29.679277"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:02:29.679495"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:02:29.679782"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:02:29.680001"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:02:29.680316"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:02:29.680531"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:02:29.680817"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:02:29.681032"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:02:29.681330"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:02:29.681545"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:02:29.681838"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:02:29.682057"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:02:29.682345"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:02:29.682582"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:02:29.682876"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:02:29.683088"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:02:29.683388"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:02:29.683602"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:02:29.683904"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:02:29.684114"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:02:29.684413"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:02:29.684627"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:02:29.684930"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:02:29.685151"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:02:29.685443"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:02:29.685670"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:02:29.685961"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:02:29.686177"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:02:29.686475"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:02:29.686683"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:02:29.686987"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:02:29.687202"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:02:29.687511"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:02:29.687723"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:02:29.688017"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:02:29.688233"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:02:29.688523"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:02:29.688747"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:02:29.689034"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:02:29.689255"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:02:29.689546"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:02:29.689771"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:02:29.690064"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:02:29.690279"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:02:29.690562"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:02:29.690776"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:02:29.691092"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:02:29.691307"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:02:29.691598"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:02:29.691812"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:02:29.692113"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:02:29.692330"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:02:29.692615"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:02:29.692842"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:02:29.693135"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:02:29.693351"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:02:29.693641"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:02:29.693858"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:02:29.694145"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:02:29.694359"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:02:29.694669"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:02:29.694891"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:02:29.695172"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:02:29.695393"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:02:29.695685"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:02:29.695900"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:02:29.696187"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:02:29.696411"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:02:29.696704"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:02:29.696937"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:02:29.697230"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:02:29.697446"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:02:29.697734"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:02:29.697949"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:02:29.698251"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:02:29.698466"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:02:29.698757"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:02:29.698975"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:02:29.699282"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:02:29.699503"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:02:29.699809"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:02:29.700042"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:02:29.700341"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:02:29.700552"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:02:29.700984"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:02:29.701231"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:02:29.701534"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:02:29.701763"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:02:29.702060"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:02:29.702276"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:02:29.702568"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:02:29.702784"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:02:29.703072"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:02:29.703286"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:02:29.703577"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:02:29.703804"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:02:29.704101"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:02:29.704328"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:02:29.704622"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:02:29.734489"], ["updated_at", "2025-11-24 00:02:29.734489"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:02:29.734831"], ["updated_at", "2025-11-24 00:02:29.734831"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "w9vsr67uye3aejdb4trr39bp9pn6"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:02:29.735425"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.736656"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:02:29.737867"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 2], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:04.332854', '2025-11-24 00:09:04.332855') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:04.366365', '2025-11-24 00:09:04.366367') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.420692"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.425985"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.426372"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:04.426621"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.434124"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.434516"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:04.434755"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:04.437297"], ["updated_at", "2025-11-24 00:09:04.437297"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:04.437522"], ["updated_at", "2025-11-24 00:09:04.437522"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:04.440060"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-24 00:09:04.440578"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.445246"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.445563"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:04.445806"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:04.446079"], ["updated_at", "2025-11-24 00:09:04.446079"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:04.446267"], ["updated_at", "2025-11-24 00:09:04.446267"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-24 00:09:04.446447"], ["updated_at", "2025-11-24 00:09:04.446447"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.446827"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-24 00:09:04.447348"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-24 00:09:04.447828"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.449782"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.450076"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:04.450306"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.452185"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.452460"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.452813"], ["updated_at", "2025-11-24 00:09:04.452813"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:04.453288"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.459181"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.459562"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "lapupaxr41r3rowras8hbxe9dn2d"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.461151"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.461663"], ["updated_at", "2025-11-24 00:09:04.461663"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.464934"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.466032"], ["updated_at", "2025-11-24 00:09:04.466032"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "pyzcoseg7pzljs1vvsligp97dgkx"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.467532"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.467780"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:04.468824"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: pyzcoseg7pzljs1vvsligp97dgkx[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "4lagtxpvr81y8018proir90xruj9"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.470720"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:04.471003"], ["updated_at", "2025-11-24 00:09:04.471003"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:04.471191"], ["updated_at", "2025-11-24 00:09:04.471191"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.472110"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.473456"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.475014"], ["updated_at", "2025-11-24 00:09:04.475014"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9ys8ud9to510dffs88iko9542ltt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.476385"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.476640"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:04.477385"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 9ys8ud9to510dffs88iko9542ltt[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6nbjsjepwko6lbokkhopogf5o3zt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.478947"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:04.479252"], ["updated_at", "2025-11-24 00:09:04.479252"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:04.479444"], ["updated_at", "2025-11-24 00:09:04.479444"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.480402"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.481582"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.483304"], ["updated_at", "2025-11-24 00:09:04.483304"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mtspp949lkd6ko0k597qe31vd5k4"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.484700"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.484925"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.486720"], ["updated_at", "2025-11-24 00:09:04.486720"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0li45oy3ucot04gqclkj92cegpsf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.490369"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.491033"], ["updated_at", "2025-11-24 00:09:04.491033"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "izyha2p3447sdutmydh41mz3mc36"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.491734"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.492765"], ["updated_at", "2025-11-24 00:09:04.492765"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "sszlolr23kzqmj8kwzcrgujw6hcg"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.493417"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "oib9s6c8icpmhkdx4vzk3dbr23dr"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.494062"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-24 00:09:04.496543"], ["updated_at", "2025-11-24 00:09:04.496543"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "qs9p3t1v2awivdrr8n3tt8utnguy"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.497128"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "9gdebzy5socy1i8puuimbwzsltwq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.497695"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "hew1y8gzkhajoyzbvur5xoz33ybr"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.498777"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.499974"], ["updated_at", "2025-11-24 00:09:04.499974"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7roal3nuxt2fgx6cf41uulmjh9em"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.500337"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.500921"], ["updated_at", "2025-11-24 00:09:04.500921"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "uof8xpz9vgvt57jy3vfw5ja85spb"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.501288"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.502112"], ["updated_at", "2025-11-24 00:09:04.502112"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "6gopgh0d6597e6ogd7iar3ycctmg"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.502841"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.503522"], ["updated_at", "2025-11-24 00:09:04.503522"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s67tnte5etup35te6vuvdyvfonz1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:04.504226"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.506818"]]
  [1m[36mActiveStorage::Blob Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.514998"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.515428"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.518728"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.519111"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:09:04.520946"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:09:04.521228"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:09:04.521484"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:09:04.521715"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:09:04.521939"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:04.524500"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:04.524820"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] Performing ActiveStorageDedup::DeduplicationJob (Job ID: ee8aac56-db6f-4077-9e49-c33b3b2ed887) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [ee8aac56-db6f-4077-9e49-c33b3b2ed887] Performed ActiveStorageDedup::DeduplicationJob (Job ID: ee8aac56-db6f-4077-9e49-c33b3b2ed887) from Test(default) in 1.43ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.527109"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:04.528181"], ["updated_at", "2025-11-24 00:09:04.528181"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "poh8wgtt2lkjhjffzwf9rsnb7uma"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.528868"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.530029"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 5], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "xct1acogokbfr4ks150o03uu1gyj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.531927"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:09:04.533145"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:09:04.533511"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:09:04.533741"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:09:04.534055"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:09:04.534275"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:09:04.534580"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:09:04.534804"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:09:04.535103"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:09:04.535329"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:09:04.535635"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:09:04.535992"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:09:04.536410"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:09:04.536684"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:09:04.537030"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:09:04.537269"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:09:04.537593"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:09:04.537827"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:09:04.538224"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:09:04.538465"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:09:04.538784"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:09:04.539029"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:09:04.539344"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:09:04.539573"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:09:04.539884"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:09:04.540130"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:09:04.540444"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:09:04.540674"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:09:04.540988"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:09:04.541218"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:09:04.541549"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:09:04.541779"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:09:04.542099"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:09:04.542331"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:09:04.542643"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:09:04.542872"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:09:04.543184"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:09:04.543413"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:09:04.543726"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:09:04.543977"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:09:04.544288"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:09:04.544521"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:09:04.544841"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:09:04.545073"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:09:04.545385"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:09:04.545614"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:09:04.545939"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:09:04.546173"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:09:04.546499"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:09:04.546728"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:09:04.547040"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:09:04.547269"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:09:04.547579"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:09:04.547820"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:09:04.548136"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:09:04.548364"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:09:04.548673"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:09:04.548899"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:09:04.549221"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:09:04.549448"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:09:04.549770"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:09:04.550000"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:09:04.550313"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:09:04.550544"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:09:04.550855"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:09:04.551083"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:09:04.551393"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:09:04.551647"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:09:04.551959"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:09:04.552193"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:09:04.552590"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:09:04.552832"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:09:04.553143"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:09:04.553375"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:09:04.553682"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:09:04.553907"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:09:04.554224"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:09:04.554444"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:09:04.554742"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:09:04.554960"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:09:04.555259"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:09:04.555489"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:09:04.555788"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:09:04.556009"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:09:04.556307"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:09:04.556526"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:09:04.556835"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:09:04.557068"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:09:04.557380"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:09:04.557599"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:09:04.557895"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:09:04.558122"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:09:04.558420"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:09:04.558638"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:09:04.558936"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:09:04.559177"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:09:04.559474"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:09:04.559691"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:09:04.559992"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:09:04.560209"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:09:04.560504"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:09:04.560721"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:09:04.561041"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:09:04.561271"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:09:04.561583"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:09:04.561802"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:09:04.562097"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:09:04.562317"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:09:04.562618"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:09:04.562859"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:09:04.563154"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:09:04.563371"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:09:04.563669"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:09:04.563890"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:09:04.564205"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:09:04.564437"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:09:04.565060"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:09:04.565383"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:09:04.565720"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:09:04.565974"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:09:04.566298"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:09:04.566530"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:09:04.566851"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:09:04.567115"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:09:04.567436"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:09:04.567668"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:09:04.567992"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:09:04.568225"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:09:04.568536"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:09:04.568768"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:09:04.569119"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:09:04.569376"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:09:04.569698"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:09:04.569927"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:09:04.570228"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:09:04.570465"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:09:04.570796"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:09:04.571016"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:09:04.571320"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:09:04.571545"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:09:04.571846"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:09:04.572064"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:09:04.572372"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:09:04.572591"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:09:04.572899"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:09:04.573116"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:09:04.573414"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:09:04.573642"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:09:04.573942"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:09:04.574162"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:09:04.574469"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:04.615027"], ["updated_at", "2025-11-24 00:09:04.615027"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:04.615392"], ["updated_at", "2025-11-24 00:09:04.615392"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "fajc6riwd8z11fx42u6b6mrc4fyq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:04.616008"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.617298"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:04.618588"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 2], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:14.029804', '2025-11-24 00:09:14.029805') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:14.052315', '2025-11-24 00:09:14.052316') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.095312"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.100014"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.100473"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:14.100737"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.109182"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.109598"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:14.109854"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:14.112447"], ["updated_at", "2025-11-24 00:09:14.112447"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:14.112688"], ["updated_at", "2025-11-24 00:09:14.112688"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:14.115694"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-24 00:09:14.116293"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.121367"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.121752"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:14.122007"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:14.122299"], ["updated_at", "2025-11-24 00:09:14.122299"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:14.122497"], ["updated_at", "2025-11-24 00:09:14.122497"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-24 00:09:14.122680"], ["updated_at", "2025-11-24 00:09:14.122680"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.123092"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-24 00:09:14.123651"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-24 00:09:14.124156"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.126233"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.126533"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:14.126772"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.128728"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.129013"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.129296"], ["updated_at", "2025-11-24 00:09:14.129296"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:14.129773"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.135922"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.136343"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "mnvfncsvvvnodd3mfrl0y2wpcgcf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.138127"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.138637"], ["updated_at", "2025-11-24 00:09:14.138637"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.142099"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.143089"], ["updated_at", "2025-11-24 00:09:14.143089"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "12jo27tnuj4oo56bm6qmdaeyoceb"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.144464"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.144691"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:14.145795"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 12jo27tnuj4oo56bm6qmdaeyoceb[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3t9jeslkmijkfbef6ndtzgx2rxoh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.147423"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:14.147685"], ["updated_at", "2025-11-24 00:09:14.147685"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:14.147875"], ["updated_at", "2025-11-24 00:09:14.147875"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.148747"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.150084"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.151597"], ["updated_at", "2025-11-24 00:09:14.151597"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "7d3cw68x2c7si2iu6r873w4uxip2"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.152994"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.153218"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:14.153934"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: 7d3cw68x2c7si2iu6r873w4uxip2[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "m7105wa8mtwwj0gzy97e41jwwvxd"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.155336"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:14.155590"], ["updated_at", "2025-11-24 00:09:14.155590"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:14.155774"], ["updated_at", "2025-11-24 00:09:14.155774"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.156653"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.157787"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.159316"], ["updated_at", "2025-11-24 00:09:14.159316"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ykga7p6g77stud0ctmex979mcok7"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.160608"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.160821"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.162331"], ["updated_at", "2025-11-24 00:09:14.162331"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "5sbut8ryotw30s6jlg014ajf6tk8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.165948"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.166598"], ["updated_at", "2025-11-24 00:09:14.166598"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "d5iaw05x2igg9iicwfz20bpi650f"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.167270"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.168257"], ["updated_at", "2025-11-24 00:09:14.168257"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "1rgnci1nbcsx8kynh2115ee0u1ta"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.168870"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "28d7p0ixccrd71zh6o52pj6dskk8"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.169523"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-24 00:09:14.171731"], ["updated_at", "2025-11-24 00:09:14.171731"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "vgumlpbhojlnfxjz0e4xqo4fedu6"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.172290"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "qzo3lf1vx84gcbf23adf2pgpca8n"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.172854"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "3ky872epc4ur17xc6zfflbf2yi5g"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.173975"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.175096"], ["updated_at", "2025-11-24 00:09:14.175096"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s12z013nyqp4f25kwfv4quriezoq"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.175457"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.176026"], ["updated_at", "2025-11-24 00:09:14.176026"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "00l2eh8bw3lvvil80am7t3ifwfiu"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.176374"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.177178"], ["updated_at", "2025-11-24 00:09:14.177178"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ntmaggu6ylcr3liinws9sunp7juj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.177793"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.178333"], ["updated_at", "2025-11-24 00:09:14.178333"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b47y6qrftx3iq6s7blzftx3qtuit"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:14.178973"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.181349"]]
  [1m[36mActiveStorage::Blob Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.189316"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.189770"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.192748"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.193056"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:09:14.194958"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:09:14.195255"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:09:14.195504"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:09:14.195738"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:09:14.195974"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:14.198469"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:14.198754"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 2cc9869b-b084-4b82-8823-e82cbd6738c9) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [2cc9869b-b084-4b82-8823-e82cbd6738c9] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 2cc9869b-b084-4b82-8823-e82cbd6738c9) from Test(default) in 1.97ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.201625"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:14.202990"], ["updated_at", "2025-11-24 00:09:14.202990"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "bk3wh6cmqkhef7h8wy2sfgvgn8f0"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.203643"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.204782"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 5], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "y7b9e3k0lrssddnxngjie6wkm4v1"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.206690"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:09:14.207907"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:09:14.208267"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:09:14.208494"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:09:14.208842"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:09:14.209061"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:09:14.209362"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:09:14.209580"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:09:14.209876"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:09:14.210098"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:09:14.210391"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:09:14.210626"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:09:14.210932"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:09:14.211150"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:09:14.211444"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:09:14.211659"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:09:14.211952"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:09:14.212171"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:09:14.212478"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:09:14.212698"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:09:14.212991"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:09:14.213220"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:09:14.213514"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:09:14.213734"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:09:14.214028"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:09:14.214255"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:09:14.214547"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:09:14.214763"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:09:14.215056"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:09:14.215274"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:09:14.215579"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:09:14.215794"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:09:14.216103"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:09:14.216318"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:09:14.216610"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:09:14.216834"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:09:14.217129"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:09:14.217345"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:09:14.217638"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:09:14.217875"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:09:14.218177"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:09:14.218394"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:09:14.218687"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:09:14.218917"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:09:14.219343"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:09:14.219669"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:09:14.220009"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:09:14.220243"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:09:14.220571"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:09:14.220800"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:09:14.221112"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:09:14.221343"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:09:14.221653"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:09:14.221893"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:09:14.222200"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:09:14.222426"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:09:14.222740"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:09:14.222966"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:09:14.223285"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:09:14.223514"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:09:14.223833"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:09:14.224059"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:09:14.224364"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:09:14.224594"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:09:14.224899"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:09:14.225126"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:09:14.225430"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:09:14.225688"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:09:14.225997"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:09:14.226223"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:09:14.226531"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:09:14.226770"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:09:14.227074"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:09:14.227300"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:09:14.227624"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:09:14.227850"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:09:14.228168"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:09:14.228396"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:09:14.228703"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:09:14.228930"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:09:14.229248"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:09:14.229487"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:09:14.229794"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:09:14.230022"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:09:14.230328"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:09:14.230554"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:09:14.230871"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:09:14.231109"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:09:14.231427"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:09:14.231652"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:09:14.231957"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:09:14.232182"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:09:14.232488"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:09:14.232713"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:09:14.233017"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:09:14.233265"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:09:14.233570"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:09:14.233795"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:09:14.234101"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:09:14.234326"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:09:14.234632"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:09:14.234857"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:09:14.235175"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:09:14.235411"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:09:14.235779"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:09:14.236043"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:09:14.236367"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:09:14.236594"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:09:14.236894"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:09:14.237126"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:09:14.237422"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:09:14.237640"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:09:14.237935"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:09:14.238151"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:09:14.238454"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:09:14.238682"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:09:14.238987"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:09:14.239203"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:09:14.239498"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:09:14.239725"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:09:14.240016"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:09:14.240232"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:09:14.240526"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:09:14.240762"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:09:14.241053"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:09:14.241271"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:09:14.241569"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:09:14.241785"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:09:14.242078"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:09:14.242297"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:09:14.242600"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:09:14.242817"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:09:14.243136"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:09:14.243355"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:09:14.243648"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:09:14.243863"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:09:14.244188"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:09:14.244416"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:09:14.244712"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:09:14.244932"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:09:14.245221"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:09:14.245436"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:09:14.245745"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:09:14.245957"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:09:14.246270"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:09:14.246483"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:09:14.246772"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:09:14.246989"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:09:14.247285"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:09:14.247498"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:09:14.247809"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:14.288220"], ["updated_at", "2025-11-24 00:09:14.288220"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:14.288574"], ["updated_at", "2025-11-24 00:09:14.288574"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "t2yhtpymgu65f36mav8qp2a174ja"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:14.289171"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.290455"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:14.291690"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 2], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:22.295572', '2025-11-24 00:09:22.295573') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
[ActiveStorageDedup] Initializing ActiveStorageDedup gem...
[ActiveStorageDedup] Patching ActiveStorage::Attached::Changes::CreateOne with ChangesExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attached::Changes::CreateOne patched successfully
[ActiveStorageDedup] Extending ActiveRecord with AttachmentOptions module
[ActiveStorageDedup] âœ“ ActiveRecord extended successfully
[ActiveStorageDedup] âœ“ Gem initialization complete
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_blobs"[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE TABLE "active_storage_blobs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "key" varchar NOT NULL, "filename" varchar NOT NULL, "content_type" varchar, "metadata" text, "service_name" varchar NOT NULL, "byte_size" bigint NOT NULL, "checksum" varchar, "reference_count" integer DEFAULT 0 NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_blobs_on_key" ON "active_storage_blobs" ("key")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_blobs_on_checksum_and_service" ON "active_storage_blobs" ("checksum", "service_name")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "active_storage_attachments"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "active_storage_attachments" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar NOT NULL, "record_type" varchar NOT NULL, "record_id" integer NOT NULL, "blob_id" integer NOT NULL, "created_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE INDEX "index_active_storage_attachments_on_blob_id" ON "active_storage_attachments" ("blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_active_storage_attachments_uniqueness" ON "active_storage_attachments" ("record_type", "record_id", "name", "blob_id")[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "users"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "users" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "posts"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "posts" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "title" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "products"[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "products" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "name" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.0ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = ? ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.0ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-11-24 00:09:22.326788', '2025-11-24 00:09:22.326790') RETURNING "key"[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Registered attachment ActiveStorage::Blob#preview_image with deduplicate=true
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
[ActiveStorageDedup] Patching ActiveStorage::Blob with BlobDeduplication module
[ActiveStorageDedup] âœ“ ActiveStorage::Blob patched successfully
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.381387"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.387074"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.387534"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:22.387795"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveStorageDedup] Patching ActiveStorage::Attachment with AttachmentExtension module
[ActiveStorageDedup] âœ“ ActiveStorage::Attachment patched successfully
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.2ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.395743"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.396086"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:22.396331"]]
[ActiveStorageDedup] Registered attachment User#avatar with deduplicate=true
[ActiveStorageDedup] Registered attachment User#documents with deduplicate=true
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:22.398766"], ["updated_at", "2025-11-24 00:09:22.398766"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:22.398994"], ["updated_at", "2025-11-24 00:09:22.398994"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:22.401428"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 3], ["created_at", "2025-11-24 00:09:22.401981"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.406899"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.407238"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:22.407482"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:22.407770"], ["updated_at", "2025-11-24 00:09:22.407770"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:22.407968"], ["updated_at", "2025-11-24 00:09:22.407968"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 3"], ["created_at", "2025-11-24 00:09:22.408151"], ["updated_at", "2025-11-24 00:09:22.408151"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.408542"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 2], ["created_at", "2025-11-24 00:09:22.409079"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 3], ["blob_id", 3], ["created_at", "2025-11-24 00:09:22.409580"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 3]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 2
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 3
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.411601"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup1-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.411896"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup2-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:59:22.412137"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 3 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 2 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup1-key[0m
[ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveStorageDedup] Merging blob 3 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
[ActiveStorageDedup] Moving 0 attachment(s) from blob 3 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 0
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup2-key[0m
[ActiveStorageDedup] âœ— Error merging blob 3: NoMethodError - undefined method 'start_with?' for nil
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.414173"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.414454"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.414737"], ["updated_at", "2025-11-24 00:09:22.414737"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 2], ["created_at", "2025-11-24 00:09:22.415194"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 2]]
[ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveStorageDedup] Merging blob 2 into keeper 1...
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveStorageDedup] Moving 1 attachment(s) from blob 2 to 1
  [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Updated keeper 1 reference_count to 1
[ActiveStorageDedup] âœ— Error merging blob 2: StandardError - Test error
[ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:188:in 'block in RSpec::Mocks::MessageExpectation#and_raise'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:797:in 'block in RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'Array#map'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:796:in 'RSpec::Mocks::Implementation#call'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/rspec-mocks-3.13.7/lib/rspec/mocks/message_expectation.rb:654:in 'RSpec::Mocks::MessageExpectation::ImplementationDetails#invoke_incrementing_actual_calls_by'
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "local-key"], ["filename", "test.txt"], ["service_name", "local"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.421175"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "s3-key"], ["filename", "test.txt"], ["service_name", "s3"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.421566"]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "m47qwheuf09c9rxd7kd7zeon2syy"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.423209"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.423724"], ["updated_at", "2025-11-24 00:09:22.423724"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.427425"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.428573"], ["updated_at", "2025-11-24 00:09:22.428573"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dd2v9q1dxbojver1q1jewr1yvg1k"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.430097"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.430368"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:22.431655"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dd2v9q1dxbojver1q1jewr1yvg1k[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "f2bzdjoi5udp5dr6pmry8tcq4stu"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.433460"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:22.433758"], ["updated_at", "2025-11-24 00:09:22.433758"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:22.433966"], ["updated_at", "2025-11-24 00:09:22.433966"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.435012"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.436629"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.438382"], ["updated_at", "2025-11-24 00:09:22.438382"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dxlexsxdhoua5q8xpjj6c9y6vv5d"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.439836"]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.440083"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mUser Update (0.0ms)[0m  [1m[33mUPDATE "users" SET "updated_at" = ? WHERE "users"."id" = ?[0m  [["updated_at", "2025-11-24 00:09:22.440836"], ["id", 1]]
  [1m[36mActiveStorage::Attachment Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ? LIMIT ?[0m  [["blob_id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "ActiveStorage::Blob"], ["name", "preview_image"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ?[0m  [["id", 1]]
[36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dxlexsxdhoua5q8xpjj6c9y6vv5d[0m
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "b65z3inffd4vwn06kujdmutomoll"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.442340"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:22.442605"], ["updated_at", "2025-11-24 00:09:22.442605"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:22.442793"], ["updated_at", "2025-11-24 00:09:22.442793"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.443723"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.444932"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Checking if blob 1 should be purged (attachment destroyed)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
[ActiveStorageDedup] Blob 1 reference_count: 1
[ActiveStorageDedup] Keeping blob 1 (still has 1 reference(s))
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.446784"], ["updated_at", "2025-11-24 00:09:22.446784"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: Hash
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=lHP90NiApDwht..., service=test
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: lHP90NiApDwh...)
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "690gq66jzb26fxt595k9f00zed5y"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.448405"]]
  [1m[36mActiveStorage::Attachment Create (0.2ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.448678"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Destroy (0.0ms)[0m  [1m[31mDELETE FROM "active_storage_attachments" WHERE "active_storage_attachments"."id" = ?[0m  [["id", 1]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) - ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.451723"], ["updated_at", "2025-11-24 00:09:22.451723"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "0y8dbai9f8lotqndx8dvbty6ye7x"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.455406"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.456151"], ["updated_at", "2025-11-24 00:09:22.456151"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "8sclodkybp2aang5jqb8dfvcgofs"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.456868"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.457926"], ["updated_at", "2025-11-24 00:09:22.457926"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "54aa1d2thv41yx8tnsf9wg87fpay"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.458570"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=s3
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "s3"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "jwu7bl99pvuzwl2wthqqv7sdj7si"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "s3"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.459221"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Registered attachment Product#photo with deduplicate=false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mProduct Create (0.0ms)[0m  [1m[32mINSERT INTO "products" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test Product"], ["created_at", "2025-11-24 00:09:22.461676"], ["updated_at", "2025-11-24 00:09:22.461676"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "cob9o3l0bkk6zs4z6g4fv8tzukgd"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.462349"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=Product, attachment=photo
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "fdmueexjurwa3hwedydsi7mr3dub"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.462986"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "95hbrmrvmyp19itugbluip8s8gur"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.464317"]]
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.465548"], ["updated_at", "2025-11-24 00:09:22.465548"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "z0lq08cjtlu6orxljcrivn1x3she"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.465935"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.466533"], ["updated_at", "2025-11-24 00:09:22.466533"]]
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, creating new blob
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "ddcxsf3nl80w6wzpipnxqnkl0r49"], ["filename", "test.txt"], ["content_type", "text/plain"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.466903"]]
[ActiveStorageDedup] Created new blob 1 for direct upload test.txt
[ActiveStorageDedup] create_before_direct_upload! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Checksum provided by client: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 for direct upload (checksum: x4UGDIZnlswqF..., service: local)
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.467754"], ["updated_at", "2025-11-24 00:09:22.467754"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "gkh08j1gmvc4yohnr1ohcmrywxgt"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.468406"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.469095"], ["updated_at", "2025-11-24 00:09:22.469095"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] No duplicate found, will use new blob
[ActiveStorageDedup] Creating new blob for test.txt (checksum: x4UGDIZnlswq...)
[ActiveStorageDedup] Saving new blob...
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "y1930xso4evpb2sir7f8ud5rjazw"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "local"], ["byte_size", 17], ["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["created_at", "2025-11-24 00:09:22.469844"]]
[ActiveStorageDedup] Created and saved new blob 1 for test.txt
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Building blob to compute checksum...
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=User, attachment=avatar
[ActiveStorageDedup] Blob built with checksum: x4UGDIZnlswq...
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication enabled: true
[ActiveStorageDedup] Checking for duplicates: checksum=x4UGDIZnlswqF..., service=local
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? LIMIT ?[0m  [["checksum", "x4UGDIZnlswqFwjJlxVMjg=="], ["service_name", "local"], ["LIMIT", 1]]
[ActiveStorageDedup] âœ“ Reusing existing blob 1 (checksum: x4UGDIZnlswqF..., service: local)
[ActiveStorageDedup] build_after_unfurling returned existing blob 1
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Configuration initialized with defaults: enabled=true, deduplicate_by_default=true, auto_purge_orphans=true
[ActiveStorageDedup] Deduplication check for User#avatar: true (model-level override)
[ActiveStorageDedup] Deduplication check for Product#photo: false (model-level override)
[ActiveStorageDedup] Gem is disabled globally (enabled=false)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.472206"]]
  [1m[36mActiveStorage::Blob Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "active_storage_blobs" GROUP BY "active_storage_blobs"."checksum", "active_storage_blobs"."service_name" HAVING (COUNT(*) > 1) LIMIT ?[0m  [["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.480094"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 1024], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.480558"]]
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.483659"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "large.txt"], ["service_name", "test"], ["byte_size", 5242880], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.483965"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-0"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-24 00:09:22.485782"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-1"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 23:09:22.486151"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group1-2"], ["filename", "file1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["created_at", "2025-11-23 22:09:22.486408"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-0"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-24 00:09:22.486643"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "group2-1"], ["filename", "file2.txt"], ["service_name", "test"], ["byte_size", 200], ["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["created_at", "2025-11-23 23:09:22.486876"]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "flXbAB0xmpSwtxNSmnVmIw=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC LIMIT ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ?[0m  [["checksum", "7qZw9KyUHfcaO18mjr4+rA=="], ["service_name", "test"]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "keeper-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:09:22.489461"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "dup-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-23 23:39:22.489744"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] Performing ActiveStorageDedup::DeduplicationJob (Job ID: 6324df24-daec-49ac-b66d-e6bca44e91ae) from Test(default)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] ðŸ” Starting sanity check - scanning for duplicate blobs...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Found 1 group(s) with duplicates
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Processing duplicate group: checksum=lHP90NiApDwht..., service=test
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae]   [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."checksum" = ? AND "active_storage_blobs"."service_name" = ? ORDER BY "active_storage_blobs"."created_at" ASC[0m  [["checksum", "lHP90NiApDwht3eNNIchVw=="], ["service_name", "test"]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Found 2 blob(s) with checksum lHP90NiApDwht...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] ðŸ”„ Merging 1 duplicate(s) into blob 1 (checksum: lHP90NiApDwht...)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Merging blob 2 into keeper 1...
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae]   [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Moving 0 attachment(s) from blob 2 to 1
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae]   [1m[36mActiveStorage::Attachment Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_attachments" SET "blob_id" = ? WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1], ["blob_id", 2]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae]   [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Updated keeper 1 reference_count to 0
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [36m  Disk Storage (0.0ms) [0m[31mDeleted file from key: dup-key[0m
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] âœ— Error merging blob 2: NoMethodError - undefined method 'start_with?' for nil
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] Error backtrace: /Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:192:in 'ActiveStorage::Blob#image?'
/Users/coderhs/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/activestorage-8.1.1/app/models/active_storage/blob.rb:308:in 'ActiveStorage::Blob#delete'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:90:in 'ActiveStorageDedup::DeduplicationJob#merge_duplicate'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:68:in 'block in ActiveStorageDedup::DeduplicationJob#process_duplicate_group'
/Users/coderhs/sandbox/active_storage_dedup/lib/active_storage_dedup/deduplication_job.rb:67:in 'Array#each'
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] [ActiveStorageDedup] âœ“ Sanity check complete - merged 1 duplicate blob(s)
[ActiveJob] [ActiveStorageDedup::DeduplicationJob] [6324df24-daec-49ac-b66d-e6bca44e91ae] Performed ActiveStorageDedup::DeduplicationJob (Job ID: 6324df24-daec-49ac-b66d-e6bca44e91ae) from Test(default) in 1.49ms
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "test-key"], ["filename", "test.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.492094"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "Test User"], ["created_at", "2025-11-24 00:09:22.493179"], ["updated_at", "2025-11-24 00:09:22.493179"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "2is8gjm3ph92dm0825owisytgyvj"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.493796"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.494880"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 5], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "bewsr9oophwba2i3xhhhi5xjr3mh"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.496755"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-0"], ["filename", "file-0.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "jmibqIuS5AIMZQjopz5OwQ=="], ["created_at", "2025-11-24 00:09:22.497997"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 1]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-1"], ["filename", "file-1.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "koyuYjFLlVJ5GO5KJEfaAQ=="], ["created_at", "2025-11-24 00:09:22.498354"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-2"], ["filename", "file-2.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YQvR/MQ+iYleyHFitlImww=="], ["created_at", "2025-11-24 00:09:22.498579"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 3]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-3"], ["filename", "file-3.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "bet9XKaIQPB9jlZ2TI3Gcw=="], ["created_at", "2025-11-24 00:09:22.498888"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-4"], ["filename", "file-4.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "J93UW2nnIb4d7JCGDLOcXg=="], ["created_at", "2025-11-24 00:09:22.499115"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 5]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-5"], ["filename", "file-5.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OoIHDkDGk0sqHLHDgdn2Lg=="], ["created_at", "2025-11-24 00:09:22.499411"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-6"], ["filename", "file-6.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "YZH7Z/BdShZoANYvrHFM/A=="], ["created_at", "2025-11-24 00:09:22.499630"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 7]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-7"], ["filename", "file-7.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Cfe1pApkdZR72f/W0AkTXg=="], ["created_at", "2025-11-24 00:09:22.499930"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-8"], ["filename", "file-8.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "L4mq226dGif4c+0f/+Mwrw=="], ["created_at", "2025-11-24 00:09:22.500147"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 9]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-9"], ["filename", "file-9.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s0csGhAmEXt9S2CpCEitjg=="], ["created_at", "2025-11-24 00:09:22.500443"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-10"], ["filename", "file-10.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/X8N81WBg/bLThT2AVQEeg=="], ["created_at", "2025-11-24 00:09:22.500724"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 11]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-11"], ["filename", "file-11.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xgCg8UE/LyJLcP68m0v5lQ=="], ["created_at", "2025-11-24 00:09:22.501037"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-12"], ["filename", "file-12.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pR1ETuaQ+4ysM8+N3YnFkA=="], ["created_at", "2025-11-24 00:09:22.501255"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 13]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-13"], ["filename", "file-13.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "R5TbCYXKjPOPrvLRjinoUw=="], ["created_at", "2025-11-24 00:09:22.501549"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-14"], ["filename", "file-14.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uJ2Glv6w6+6avF6WaiQ0Tg=="], ["created_at", "2025-11-24 00:09:22.501769"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 15]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-15"], ["filename", "file-15.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PiVMNqeP5uMfb2nd3+HUiA=="], ["created_at", "2025-11-24 00:09:22.502062"]]
  [1m[36mActiveStorage::Blob Create (0.1ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-16"], ["filename", "file-16.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OW1Dc90tgy+QLS6jLO+wXg=="], ["created_at", "2025-11-24 00:09:22.502345"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 17]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-17"], ["filename", "file-17.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mzhSucWmCbMDanC6Yra8qA=="], ["created_at", "2025-11-24 00:09:22.502823"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-18"], ["filename", "file-18.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "s7aMV5hDqzte7DP1nEIWxQ=="], ["created_at", "2025-11-24 00:09:22.503073"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 19]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-19"], ["filename", "file-19.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "y4f0NBlWiKndHLd1zPO2Rw=="], ["created_at", "2025-11-24 00:09:22.503404"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-20"], ["filename", "file-20.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/r3ZTKcgxQG4K8a+r8W8dQ=="], ["created_at", "2025-11-24 00:09:22.503646"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 21]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-21"], ["filename", "file-21.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lDIZd6TMBFBVH/775laLRw=="], ["created_at", "2025-11-24 00:09:22.503953"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-22"], ["filename", "file-22.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "zMJuV2agB4ZyDB5aMSj+YA=="], ["created_at", "2025-11-24 00:09:22.504173"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 23]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-23"], ["filename", "file-23.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Ty5NwxM2HkrSDL2dRodhYQ=="], ["created_at", "2025-11-24 00:09:22.504484"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-24"], ["filename", "file-24.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JoG4l7x/t4Pe5EscvJ0Srg=="], ["created_at", "2025-11-24 00:09:22.504722"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 25]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-25"], ["filename", "file-25.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "31MJmdKTbhdx+wA2uSlz8Q=="], ["created_at", "2025-11-24 00:09:22.505022"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-26"], ["filename", "file-26.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VfHVSwwwB/GLW3GmTuPFKw=="], ["created_at", "2025-11-24 00:09:22.505242"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 27]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-27"], ["filename", "file-27.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "d3INRvy2iz6pAzDK1u83nA=="], ["created_at", "2025-11-24 00:09:22.505539"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-28"], ["filename", "file-28.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WFtaH4HAD66yGQAbvJgVdA=="], ["created_at", "2025-11-24 00:09:22.505756"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 29]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-29"], ["filename", "file-29.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "h2geMt/il/SILNMuhGJvvg=="], ["created_at", "2025-11-24 00:09:22.506063"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-30"], ["filename", "file-30.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uy22JvQuz8vDyp9bCiP3CA=="], ["created_at", "2025-11-24 00:09:22.506280"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 31]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-31"], ["filename", "file-31.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rr/+4cpj3i+VOxkrVf+xmw=="], ["created_at", "2025-11-24 00:09:22.506589"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-32"], ["filename", "file-32.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wD5JWXNDy8uTDpOfBBh3fg=="], ["created_at", "2025-11-24 00:09:22.506809"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 33]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-33"], ["filename", "file-33.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ONGER+H5k4/zPSZZ18x/gQ=="], ["created_at", "2025-11-24 00:09:22.507101"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-34"], ["filename", "file-34.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "UDKu+DOEW+YhzLEhPSTTvQ=="], ["created_at", "2025-11-24 00:09:22.507317"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 35]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-35"], ["filename", "file-35.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SM03sMdC6F2IDl4Sz40f8Q=="], ["created_at", "2025-11-24 00:09:22.507611"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-36"], ["filename", "file-36.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rUW1gKLh4sVLIUxXHueRRA=="], ["created_at", "2025-11-24 00:09:22.507828"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 37]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-37"], ["filename", "file-37.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Mycoyx/vQrp5iCf84geL0g=="], ["created_at", "2025-11-24 00:09:22.508121"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-38"], ["filename", "file-38.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8l4desOvtAcezb08GYoS6Q=="], ["created_at", "2025-11-24 00:09:22.508360"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 39]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-39"], ["filename", "file-39.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "BD1jw//iN8jeYj8bltihCA=="], ["created_at", "2025-11-24 00:09:22.508658"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-40"], ["filename", "file-40.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RwqbDS1xCVZSbFB5Bvnkzw=="], ["created_at", "2025-11-24 00:09:22.508875"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 41]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-41"], ["filename", "file-41.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XC8nsolWSPM/xyoOI23Npg=="], ["created_at", "2025-11-24 00:09:22.509177"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-42"], ["filename", "file-42.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pRd/vN0uokGsm635Z4SthQ=="], ["created_at", "2025-11-24 00:09:22.509395"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 43]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-43"], ["filename", "file-43.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "G9IV39WyjRrfEjB+LXEn9g=="], ["created_at", "2025-11-24 00:09:22.509687"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-44"], ["filename", "file-44.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dghV7eU94f6GUwbgk02kMw=="], ["created_at", "2025-11-24 00:09:22.509903"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 45]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-45"], ["filename", "file-45.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8pGem9+rXQM0JB5C9hgTyg=="], ["created_at", "2025-11-24 00:09:22.510207"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-46"], ["filename", "file-46.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "H2/+Jsj4fvnZgg0GREMHWg=="], ["created_at", "2025-11-24 00:09:22.510423"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 47]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-47"], ["filename", "file-47.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ovfnjgFP0j0Kbj5kmba92w=="], ["created_at", "2025-11-24 00:09:22.510720"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-48"], ["filename", "file-48.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "k7XD/Xv29OW0el/m7xhfQA=="], ["created_at", "2025-11-24 00:09:22.510947"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 49]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-49"], ["filename", "file-49.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6h9QMUYXjrlzQG/xzUYd/Q=="], ["created_at", "2025-11-24 00:09:22.511242"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-50"], ["filename", "file-50.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oyJzRivPVE2DdyrR3XQorQ=="], ["created_at", "2025-11-24 00:09:22.511457"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 51]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-51"], ["filename", "file-51.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Glp3mcJirDtn3fSsca5Upg=="], ["created_at", "2025-11-24 00:09:22.511752"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-52"], ["filename", "file-52.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1u7HyBvQsbCIxIzX2kYhcg=="], ["created_at", "2025-11-24 00:09:22.511981"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 53]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-53"], ["filename", "file-53.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "NqD4VAk4VyXxMYnwVHtQlA=="], ["created_at", "2025-11-24 00:09:22.512277"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-54"], ["filename", "file-54.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dLywInmpwkVxovbHc+XBcA=="], ["created_at", "2025-11-24 00:09:22.512494"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 55]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-55"], ["filename", "file-55.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Wk+cxEaJUiW7p8VAKD0BZw=="], ["created_at", "2025-11-24 00:09:22.512800"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-56"], ["filename", "file-56.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o1OeWKNcM0NO1yXrmlckuQ=="], ["created_at", "2025-11-24 00:09:22.513017"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 57]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-57"], ["filename", "file-57.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "PRbqONX6X+9PP0WR6qP1zg=="], ["created_at", "2025-11-24 00:09:22.513320"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-58"], ["filename", "file-58.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MN6IAQUQUW7S+Np92qH/gg=="], ["created_at", "2025-11-24 00:09:22.513539"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 59]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-59"], ["filename", "file-59.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "57xvaNnntgn7cdqdcPDuHQ=="], ["created_at", "2025-11-24 00:09:22.513842"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-60"], ["filename", "file-60.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "1U0wD+sH2iRnKoHSInpPGw=="], ["created_at", "2025-11-24 00:09:22.514061"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 61]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-61"], ["filename", "file-61.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "g3CBBCUqzK11oCEaE6wheQ=="], ["created_at", "2025-11-24 00:09:22.514353"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-62"], ["filename", "file-62.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "EBzhUlT0KNFMADbsMVAhYw=="], ["created_at", "2025-11-24 00:09:22.514570"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 63]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-63"], ["filename", "file-63.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "2WznZePP3eL4/H6EZWdBqA=="], ["created_at", "2025-11-24 00:09:22.514863"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-64"], ["filename", "file-64.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "/jXKZYADXmxDDvl9Qn81RA=="], ["created_at", "2025-11-24 00:09:22.515080"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 65]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-65"], ["filename", "file-65.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+H5TX2AJx+R7LXgzlJpXRQ=="], ["created_at", "2025-11-24 00:09:22.515373"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-66"], ["filename", "file-66.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "kQe2COs/PL4UcHBmBkQ6rQ=="], ["created_at", "2025-11-24 00:09:22.515614"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 67]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-67"], ["filename", "file-67.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xQVCjkbRVya9JgD87pbbuw=="], ["created_at", "2025-11-24 00:09:22.515908"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-68"], ["filename", "file-68.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "8isF0wPSwZnr9y3TX2iBNg=="], ["created_at", "2025-11-24 00:09:22.516123"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 69]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-69"], ["filename", "file-69.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "o0y1qaKAomLG4Bsg74uOgg=="], ["created_at", "2025-11-24 00:09:22.516428"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-70"], ["filename", "file-70.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ysxVF77N+9+NiSpOj7Istw=="], ["created_at", "2025-11-24 00:09:22.516645"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 71]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-71"], ["filename", "file-71.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RgBVpx2lNtlVH+M1w9gBAA=="], ["created_at", "2025-11-24 00:09:22.516940"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-72"], ["filename", "file-72.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "oiQy/Yi5sr6eA9+lKCPY3w=="], ["created_at", "2025-11-24 00:09:22.517156"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 73]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-73"], ["filename", "file-73.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "C3Ja2ApMezrDYk7t+XGGgg=="], ["created_at", "2025-11-24 00:09:22.517469"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-74"], ["filename", "file-74.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "iKwu4B1WIZmDfTAKhS6MiQ=="], ["created_at", "2025-11-24 00:09:22.517684"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 75]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-75"], ["filename", "file-75.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GWWJ3/rIZng1dRk7MLjHHg=="], ["created_at", "2025-11-24 00:09:22.517989"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-76"], ["filename", "file-76.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lA3LZy09Z1p4CNEtKqDS+A=="], ["created_at", "2025-11-24 00:09:22.518204"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 77]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-77"], ["filename", "file-77.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "JV4Hc8svaXoUAVLc9jjZOA=="], ["created_at", "2025-11-24 00:09:22.518496"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-78"], ["filename", "file-78.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xCMHB3EO27PZofmZK9Yl8A=="], ["created_at", "2025-11-24 00:09:22.518712"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 79]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-79"], ["filename", "file-79.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5tyv2ekbQxn0xk5Y7g/FCA=="], ["created_at", "2025-11-24 00:09:22.519154"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-80"], ["filename", "file-80.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "lCoNF621wHy0J5NV9pQ+nQ=="], ["created_at", "2025-11-24 00:09:22.519434"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 81]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-81"], ["filename", "file-81.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "6D+VEqPIlF84GzjYzCD7iQ=="], ["created_at", "2025-11-24 00:09:22.519764"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-82"], ["filename", "file-82.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gBlaRTqBMijvN1q2wWR+Ow=="], ["created_at", "2025-11-24 00:09:22.519998"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 83]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-83"], ["filename", "file-83.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "A7sKSIBSLyryTJfM/5lVhQ=="], ["created_at", "2025-11-24 00:09:22.520315"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-84"], ["filename", "file-84.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gYdGWA6RyWfBf86Hcd1V9g=="], ["created_at", "2025-11-24 00:09:22.520544"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 85]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-85"], ["filename", "file-85.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+uMNt2mL+bw90CPs4BAuZg=="], ["created_at", "2025-11-24 00:09:22.520870"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-86"], ["filename", "file-86.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SmgeKYa3CbLBeFak664cQ=="], ["created_at", "2025-11-24 00:09:22.521114"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 87]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-87"], ["filename", "file-87.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RTAqPdu5RZrtq2A1HXb1og=="], ["created_at", "2025-11-24 00:09:22.521437"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-88"], ["filename", "file-88.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "SGLSLp4KaV9H4AokinOPcg=="], ["created_at", "2025-11-24 00:09:22.521668"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 89]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-89"], ["filename", "file-89.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "sCouoO2K/pzkHcWH/ImGzA=="], ["created_at", "2025-11-24 00:09:22.521977"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-90"], ["filename", "file-90.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dkq6xjQ/WdYEaOoEV5YD6Q=="], ["created_at", "2025-11-24 00:09:22.522206"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 91]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-91"], ["filename", "file-91.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "66PpFwrKbRlFWMONeAukeQ=="], ["created_at", "2025-11-24 00:09:22.522514"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-92"], ["filename", "file-92.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "5l8/LxfHuzIgFCMaKM68pg=="], ["created_at", "2025-11-24 00:09:22.522744"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 93]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-93"], ["filename", "file-93.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "OvTy8Prv57JUFPMOcd/r3w=="], ["created_at", "2025-11-24 00:09:22.523054"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-94"], ["filename", "file-94.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "xU/VESbS7AWnkoQ76pAmqQ=="], ["created_at", "2025-11-24 00:09:22.523305"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 95]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-95"], ["filename", "file-95.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "3SvoFaXFIEVd3hR9tlzimg=="], ["created_at", "2025-11-24 00:09:22.523614"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-96"], ["filename", "file-96.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uVzEjFjKj43DpWxkgovVqg=="], ["created_at", "2025-11-24 00:09:22.523842"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 97]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-97"], ["filename", "file-97.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wxUA5ufwDFXz5zBRgOg9qg=="], ["created_at", "2025-11-24 00:09:22.524151"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-98"], ["filename", "file-98.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+yVPb0S1RzM6nv1lUG+pcg=="], ["created_at", "2025-11-24 00:09:22.524379"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 99]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-99"], ["filename", "file-99.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mfGN7uW4eToj4h6nZJpGxg=="], ["created_at", "2025-11-24 00:09:22.524722"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-100"], ["filename", "file-100.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "50Tw3QuLYy+ExNWUMZMQXQ=="], ["created_at", "2025-11-24 00:09:22.524953"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 101]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-101"], ["filename", "file-101.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "TfSibR07xMm+MsXqKDw0hw=="], ["created_at", "2025-11-24 00:09:22.525275"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-102"], ["filename", "file-102.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "0ahE1YrM2ttkZecMMOdYLw=="], ["created_at", "2025-11-24 00:09:22.525514"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 103]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-103"], ["filename", "file-103.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "AwJ1c0kiH4cCbXoIvEdc4w=="], ["created_at", "2025-11-24 00:09:22.525834"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-104"], ["filename", "file-104.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CKLJUmbcHnYzcvXxk/K36w=="], ["created_at", "2025-11-24 00:09:22.526073"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 105]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-105"], ["filename", "file-105.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aweLcD25b10fdOnqJzskYA=="], ["created_at", "2025-11-24 00:09:22.526387"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-106"], ["filename", "file-106.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Aa1wIHNxsH5e9wZ1Yyl7Og=="], ["created_at", "2025-11-24 00:09:22.526614"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 107]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-107"], ["filename", "file-107.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "nUKThmTMdgJDPD2fd1LPZQ=="], ["created_at", "2025-11-24 00:09:22.526922"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-108"], ["filename", "file-108.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CSC0Kjsf4njeNdayfyaNsA=="], ["created_at", "2025-11-24 00:09:22.527162"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 109]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-109"], ["filename", "file-109.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ePTabUQJ86sZE3Q56PrI0Q=="], ["created_at", "2025-11-24 00:09:22.527474"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-110"], ["filename", "file-110.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "x2rn5bFn9jr21/78wZXWbg=="], ["created_at", "2025-11-24 00:09:22.527701"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 111]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-111"], ["filename", "file-111.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "VvwfbbbjB1gJN91vHb9zzw=="], ["created_at", "2025-11-24 00:09:22.528008"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-112"], ["filename", "file-112.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GSgbXPXH32D9w2H/jIFSLQ=="], ["created_at", "2025-11-24 00:09:22.528236"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 113]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-113"], ["filename", "file-113.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "fJ1xzStDOswze2H9Jfqmpg=="], ["created_at", "2025-11-24 00:09:22.528554"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-114"], ["filename", "file-114.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "XAUWbBfnJxmVG5yNepXxoQ=="], ["created_at", "2025-11-24 00:09:22.528788"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 115]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-115"], ["filename", "file-115.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Sa+u9FF4zv3jA2ClCPpOyQ=="], ["created_at", "2025-11-24 00:09:22.529113"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-116"], ["filename", "file-116.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "MOeQNaaNYtLGM+LYuwSPuA=="], ["created_at", "2025-11-24 00:09:22.529342"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 117]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-117"], ["filename", "file-117.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "rzxd1f/JdFXDORSuFdvrXQ=="], ["created_at", "2025-11-24 00:09:22.529648"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-118"], ["filename", "file-118.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "hbRlOJKPELmJfsyHfLzLoA=="], ["created_at", "2025-11-24 00:09:22.529887"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 119]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-119"], ["filename", "file-119.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "yBsePhta7hIs8xiIUeLcoA=="], ["created_at", "2025-11-24 00:09:22.530206"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-120"], ["filename", "file-120.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZbFYYRDhbHrY1KMidi+45w=="], ["created_at", "2025-11-24 00:09:22.530435"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 121]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-121"], ["filename", "file-121.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9cNtfnIaMT1pimhmm6cyXA=="], ["created_at", "2025-11-24 00:09:22.530760"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-122"], ["filename", "file-122.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "gzDhBFsua4rTL14Xf0u8YQ=="], ["created_at", "2025-11-24 00:09:22.531001"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 123]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-123"], ["filename", "file-123.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wdRj4FO6WAsSib/CJ1YpIA=="], ["created_at", "2025-11-24 00:09:22.531311"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-124"], ["filename", "file-124.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ISY5KPUeDQHlSypdyjpczQ=="], ["created_at", "2025-11-24 00:09:22.531538"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 125]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-125"], ["filename", "file-125.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "ZHldsYzy93umxjXy+GX67A=="], ["created_at", "2025-11-24 00:09:22.531844"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-126"], ["filename", "file-126.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Fxwd+lOQrvq5AR336yTVzQ=="], ["created_at", "2025-11-24 00:09:22.532071"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 127]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-127"], ["filename", "file-127.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "GjlKkGQ1kQX6l06KshSK7Q=="], ["created_at", "2025-11-24 00:09:22.532381"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-128"], ["filename", "file-128.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "QOOe4voye1CXXdtmAyQbVA=="], ["created_at", "2025-11-24 00:09:22.532615"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 129]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-129"], ["filename", "file-129.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qh0Dv3wqF1ct3FYwWs8wYw=="], ["created_at", "2025-11-24 00:09:22.532938"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-130"], ["filename", "file-130.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Os/DegSaJ1F0qKAka8jrhg=="], ["created_at", "2025-11-24 00:09:22.533169"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 131]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-131"], ["filename", "file-131.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uCfmGOlOelg8+RifKuXm5A=="], ["created_at", "2025-11-24 00:09:22.533498"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-132"], ["filename", "file-132.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "cXA6gTX6jUAe1iwC47ic1A=="], ["created_at", "2025-11-24 00:09:22.533730"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 133]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-133"], ["filename", "file-133.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "Jsm/7sKb88+JiRZONQRwGA=="], ["created_at", "2025-11-24 00:09:22.534042"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-134"], ["filename", "file-134.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "7gPpuwhhUqRB5WCAxDrFOg=="], ["created_at", "2025-11-24 00:09:22.534283"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 135]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-135"], ["filename", "file-135.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "dX6CPyeyexP8CjZHqLoz4g=="], ["created_at", "2025-11-24 00:09:22.534621"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-136"], ["filename", "file-136.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "WMM/2ugfAQwHHnFOKhyUVQ=="], ["created_at", "2025-11-24 00:09:22.534853"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 137]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-137"], ["filename", "file-137.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "+XPFkAw4x9048LIpnLAlBA=="], ["created_at", "2025-11-24 00:09:22.535161"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-138"], ["filename", "file-138.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "pwDvKbmKTs1TaP1c0uHf8g=="], ["created_at", "2025-11-24 00:09:22.535392"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 139]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-139"], ["filename", "file-139.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "S/Bs2WoJfY3rPpv0CvGrqQ=="], ["created_at", "2025-11-24 00:09:22.535870"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-140"], ["filename", "file-140.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "9AgB52owNuRRCE8RORzmNA=="], ["created_at", "2025-11-24 00:09:22.536130"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 141]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-141"], ["filename", "file-141.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qmPHm/penqeZ2yHpOA8+0g=="], ["created_at", "2025-11-24 00:09:22.536468"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-142"], ["filename", "file-142.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "RbexpHOY9ynYFDNZjHeDpA=="], ["created_at", "2025-11-24 00:09:22.536698"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 143]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-143"], ["filename", "file-143.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "wMPfj4OiiDxzIlyB8hJJww=="], ["created_at", "2025-11-24 00:09:22.537020"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-144"], ["filename", "file-144.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "qRMMQkkFStjGIg/ZG3z9rQ=="], ["created_at", "2025-11-24 00:09:22.537240"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 145]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-145"], ["filename", "file-145.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "CqME55CPpqB2qC2iR4hxoA=="], ["created_at", "2025-11-24 00:09:22.537536"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-146"], ["filename", "file-146.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "aKbtm0o7cExmhxqZMT0hUQ=="], ["created_at", "2025-11-24 00:09:22.537753"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 147]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-147"], ["filename", "file-147.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "B7Crz4kBhckHH0Lebuzvng=="], ["created_at", "2025-11-24 00:09:22.538053"]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-148"], ["filename", "file-148.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "mDnLi4Wt1aOGQLRQgNxphA=="], ["created_at", "2025-11-24 00:09:22.538337"]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 10], ["id", 149]]
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "blob-149"], ["filename", "file-149.txt"], ["service_name", "test"], ["byte_size", 100], ["checksum", "uc6597ogBzcj6V4gb2EGHQ=="], ["created_at", "2025-11-24 00:09:22.538653"]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.1ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 2]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 3]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 3]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 4]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 5]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 5]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 6]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 7]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 7]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 8]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 9]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 9]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 10]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 11]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 11]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 12]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 13]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 13]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 14]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 15]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 15]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 16]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 17]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 17]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 18]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 19]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 19]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 20]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 21]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 21]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 22]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 23]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 23]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 24]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 25]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 25]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 26]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 27]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 27]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 28]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 29]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 29]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 30]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 31]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 31]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 32]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 33]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 33]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 34]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 35]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 35]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 36]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 37]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 37]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 38]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 39]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 39]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 40]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 41]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 41]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 42]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 43]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 43]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 44]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 45]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 45]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 46]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 47]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 47]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 48]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 49]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 49]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 50]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 51]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 51]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 52]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 53]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 53]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 54]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 55]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 55]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 56]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 57]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 57]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 58]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 59]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 59]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 60]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 61]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 61]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 62]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 63]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 63]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 64]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 65]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 65]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 66]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 67]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 67]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 68]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 69]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 69]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 70]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 71]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 71]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 72]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 73]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 73]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 74]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 75]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 75]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 76]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 77]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 77]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 78]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 79]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 79]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 80]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 81]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 81]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 82]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 83]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 83]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 84]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 85]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 85]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 86]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 87]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 87]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 88]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 89]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 89]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 90]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 91]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 91]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 92]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 93]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 93]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 94]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 95]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 95]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 96]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 97]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 97]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 98]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 99]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 99]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 100]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 101]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 101]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 102]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 103]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 103]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 104]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 105]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 105]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 106]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 107]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 107]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 108]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 109]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 109]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 110]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 111]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 111]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 112]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 113]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 113]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 114]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 115]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 115]]
  [1m[36mActiveStorage::Attachment Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 116]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 117]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 117]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 118]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 119]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 119]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 120]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 121]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 121]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 122]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 123]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 123]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 124]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 125]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 125]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 126]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 127]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 127]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 128]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 129]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 129]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 130]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 131]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 131]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 132]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 133]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 133]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 134]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 135]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 135]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 136]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 137]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 137]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 138]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 139]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 139]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 140]]
  [1m[36mActiveStorage::Attachment Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 141]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 141]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 142]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 143]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 143]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 144]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 145]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 145]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 146]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 147]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 147]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 148]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 149]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 149]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[36mBEGIN immediate TRANSACTION[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 1"], ["created_at", "2025-11-24 00:09:22.578395"], ["updated_at", "2025-11-24 00:09:22.578395"]]
  [1m[36mUser Create (0.0ms)[0m  [1m[32mINSERT INTO "users" ("name", "created_at", "updated_at") VALUES (?, ?, ?) RETURNING "id"[0m  [["name", "User 2"], ["created_at", "2025-11-24 00:09:22.578790"], ["updated_at", "2025-11-24 00:09:22.578790"]]
[ActiveStorageDedup] create_after_unfurling! called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Deduplication enabled: false
[ActiveStorageDedup] Deduplication disabled, creating new blob
[ActiveStorageDedup] build_after_unfurling called for test.txt
[ActiveStorageDedup] Context: record=, attachment=
[ActiveStorageDedup] Blob built with checksum: lHP90NiApDwh...
[ActiveStorageDedup] Deduplication enabled: false
  [1m[36mActiveStorage::Blob Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_blobs" ("key", "filename", "content_type", "metadata", "service_name", "byte_size", "checksum", "created_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?) RETURNING "id"[0m  [["key", "q5zgq6o4uz1l8wwivje6cexyymmf"], ["filename", "test.txt"], ["content_type", "text/plain"], ["metadata", "{\"identified\":true}"], ["service_name", "test"], ["byte_size", 12], ["checksum", "lHP90NiApDwht3eNNIchVw=="], ["created_at", "2025-11-24 00:09:22.579407"]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 1], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 1], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.580609"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
[ActiveStorageDedup] ChangesExtension#find_or_build_blob called for avatar attachment
[ActiveStorageDedup] Attachable type: ActiveStorage::Blob
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" INNER JOIN "active_storage_attachments" ON "active_storage_blobs"."id" = "active_storage_attachments"."blob_id" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Load (0.0ms)[0m  [1m[34mSELECT "active_storage_attachments".* FROM "active_storage_attachments" WHERE "active_storage_attachments"."record_id" = ? AND "active_storage_attachments"."record_type" = ? AND "active_storage_attachments"."name" = ? LIMIT ?[0m  [["record_id", 2], ["record_type", "User"], ["name", "avatar"], ["LIMIT", 1]]
  [1m[36mActiveStorage::Attachment Create (0.0ms)[0m  [1m[32mINSERT INTO "active_storage_attachments" ("name", "record_type", "record_id", "blob_id", "created_at") VALUES (?, ?, ?, ?, ?) RETURNING "id"[0m  [["name", "avatar"], ["record_type", "User"], ["record_id", 2], ["blob_id", 1], ["created_at", "2025-11-24 00:09:22.582003"]]
  [1m[36mActiveStorage::Blob Update All (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = COALESCE("active_storage_blobs"."reference_count", 0) + ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 1], ["id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 0], ["id", 1]]
  [1m[36mActiveStorage::Blob Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_blobs"[0m
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" ORDER BY "active_storage_blobs"."id" ASC LIMIT ?[0m  [["LIMIT", 1000]]
  [1m[36mActiveStorage::Attachment Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "active_storage_attachments" WHERE "active_storage_attachments"."blob_id" = ?[0m  [["blob_id", 1]]
  [1m[36mActiveStorage::Blob Update (0.0ms)[0m  [1m[33mUPDATE "active_storage_blobs" SET "reference_count" = ? WHERE "active_storage_blobs"."id" = ?[0m  [["reference_count", 2], ["id", 1]]
  [1m[36mActiveStorage::Blob Load (0.0ms)[0m  [1m[34mSELECT "active_storage_blobs".* FROM "active_storage_blobs" WHERE "active_storage_blobs"."id" = ? LIMIT ?[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TRANSACTION[0m
